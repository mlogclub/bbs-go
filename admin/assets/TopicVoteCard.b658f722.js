import{_ as O,v as P,B as b}from"./index.51e009fb.js";import{j as F,w as m,c as E,u as t,D as i,E as n,aL as s,aM as _,aJ as f,aF as v,aK as T,F as h,C as c,G as y}from"./arco.c0e72183.js";import"./chart.eb223df5.js";import"./vue.2f126dbd.js";const A={key:0,class:"view-common"},S={class:"vc-title"},M={class:"vc-tag"},$={class:"vc-opts"},B=["title"],j={class:"opt-txt"},J={class:"opt-result"},z={class:"vc-status"},G={key:0,class:"status-end"},I={key:1,class:"status-end"},K={key:1,class:"view-pk"},R={class:"vc-title"},U={class:"vc-opts"},X=["title"],q={class:"opt-txt"},H={class:"opt-result"},Q=["title"],W={class:"opt-txt"},Y={class:"opt-result"},Z={class:"vc-status"},tt={key:0,class:"status-end"},et={key:1,class:"status-end"},V=4,ot={__name:"TopicVoteCard",props:{vote:{type:Object,default:null}},setup(D){const N=D,{t:p}=P.exports.useI18n(),o=F(null),d=F(!1);m(()=>N.vote,a=>{if(!a){o.value=null,d.value=!1;return}o.value=JSON.parse(JSON.stringify(a)),d.value=!1},{immediate:!0,deep:!0});const C=E(()=>o.value&&o.value.type===1&&Array.isArray(o.value.options)&&o.value.options.length===2),w=E(()=>{var a;return o.value?p("pages.topic.table.voteTitleMeta",{optionCount:o.value.optionCount||((a=o.value.options)==null?void 0:a.length)||0,voteNum:o.value.voteNum}):""});function k(){var r;let a=0;return(((r=o.value)==null?void 0:r.options)||[]).forEach(e=>{a+=(e==null?void 0:e.voteCount)||0}),a}function x(a){const r=k(),e=a||0;if(r<=0)return{percent:0,isFull:!1};let l=Number((e/r*100).toFixed(0));return l<0&&(l=0),l>100&&(l=100),{percent:l,isFull:l>=100}}function g(a,r){const e=k(),l=a||0;if(e<=0)return r?50:0;let u=Number((l/e*100).toFixed(0));return r&&u<30&&(u=30),u<0&&(u=0),u>100&&(u=100),u}function L(){d.value=!d.value}return(a,r)=>t(o)&&t(o).title?(c(),i("div",{key:0,class:h(["vote-view",{VOTED:t(o).voted,EXPIRED:t(o).expired}])},[t(C)?v("",!0):(c(),i("div",A,[n("div",S,[n("span",M,s(t(p)("pages.topic.table.voteTag")),1),n("span",null,s(t(o).title),1),n("span",null,"("+s(t(w))+")",1)]),n("div",$,[n("ul",null,[(c(!0),i(_,null,f(t(o).options,(e,l)=>(c(),i("li",{key:e.id,class:h(["EASE",{none:l>V-1&&!t(d),voted:e.voted,highLight:!e.voted&&t(o).expired}]),title:e.content},[n("span",{class:h(["opt-percent",{FULL:x(e.voteCount).isFull}]),style:y({width:`${x(e.voteCount).percent}%`})},null,6),n("span",j,s(e.content),1),n("span",J,s(e.voteCount),1)],10,B))),128))]),t(o).options&&t(o).options.length>V?(c(),i("button",{key:0,type:"button",class:"vc-more",onClick:L},s(t(d)?t(p)("pages.topic.table.voteCollapseOptions"):t(p)("pages.topic.table.voteExpandOptions")),1)):v("",!0)]),n("div",z,[T(s(t(p)("pages.topic.table.voteParticipants",{count:t(o).voteCount||0}))+" ",1),t(o).expired?(c(),i("span",G,s(t(p)("pages.topic.table.voteExpired")),1)):(c(),i("span",I,s(t(p)("pages.topic.table.voteExpiredAt"))+": "+s(("useFormatDate"in a?a.useFormatDate:t(b))(t(o).expiredAt)),1))])])),t(C)?(c(),i("div",K,[n("div",R,[r[0]||(r[0]=n("span",{class:"vc-tag"},null,-1)),n("span",null,s(t(o).title),1)]),n("div",U,[(c(!0),i(_,null,f(t(o).options,(e,l)=>(c(),i(_,{key:`l-${e.id}`},[l===0?(c(),i("div",{key:0,class:h("opt-item OPT"+l+(e.voted&&!t(o).expired?" highLight":"")),style:y({width:`${g(e.voteCount,!0)}%`}),title:e.content},[n("span",q,s(e.content),1),n("div",H,s(e.voteCount)+"\xA0("+s(g(e.voteCount,!1))+"%) "+s(e.voted?"\xA0\xA0"+t(p)("pages.topic.table.voteVotedShort"):""),1)],14,X)):v("",!0)],64))),128)),r[1]||(r[1]=n("i",{class:"ic-pk-b"},null,-1)),(c(!0),i(_,null,f(t(o).options,(e,l)=>(c(),i(_,{key:`r-${e.id}`},[l===1?(c(),i("div",{key:0,class:h("opt-item OPT"+l+(e.voted&&!t(o).expired?" highLight":"")),style:y({width:`${g(e.voteCount,!0)}%`}),title:e.content},[n("span",W,s(e.content),1),n("div",Y,s(e.voted?t(p)("pages.topic.table.voteVotedShort")+"\xA0\xA0":"")+" "+s(e.voteCount)+"\xA0("+s(g(e.voteCount,!1))+"%) ",1)],14,Q)):v("",!0)],64))),128))]),n("div",Z,[T(s(t(p)("pages.topic.table.voteParticipants",{count:t(o).voteCount||0}))+" ",1),t(o).expired?(c(),i("span",tt,s(t(p)("pages.topic.table.voteExpired")),1)):(c(),i("span",et,s(t(p)("pages.topic.table.voteExpiredAt"))+": "+s(("useFormatDate"in a?a.useFormatDate:t(b))(t(o).expiredAt)),1))])])):v("",!0)],2)):v("",!0)}},it=O(ot,[["__scopeId","data-v-e2e95fc1"]]);export{it as default};
