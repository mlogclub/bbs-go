import{v as X,f as Y,F as q,x as Q,a as P,B as U,p as E,A as Z}from"./index.e2988b1b.js";import{d as x,j as y,r as I,c as ee,o as te,b6 as ae,bE as se,ac as oe,aX as le,ba as ne,bA as ie,bo as re,O as de,ag as pe,bn as ue,bL as me,D as $,E as p,aI as t,aH as s,u as o,C as f,aK as d,aL as n,aE as C,b1 as ce,aW as _e,b7 as fe,bG as ge,bM as be,bm as he}from"./arco.b0f81cee.js";/* empty css                *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{_ as ke}from"./Edit.vue_vue_type_script_setup_true_lang.b9cdd460.js";import{_ as ye}from"./ShowPassword.vue_vue_type_script_setup_true_lang.42721945.js";import"./chart.37105098.js";import"./vue.76373e4c.js";import"./ImageUpload.82323391.js";/* empty css                *//* empty css               *//* empty css               */const $e={class:"container"},we={class:"container-header"},ve={class:"container-main"},Se=["href"],Ve=["href"],ze=["src"],Te={key:1},Pe=["href"],Ue=["href"],et=x({__name:"index",setup(Ee){const{t:m}=X.exports.useI18n(),g=Y(),h=y(!1),w=y(),v=y(),i=I({limit:20,page:1,id:void 0,username:void 0,nickname:void 0,type:void 0}),u=I({page:{page:1,limit:20,total:0},results:[]}),D=ee(()=>({total:u.page.total,current:u.page.page,pageSize:u.page.limit,showTotal:!0,showJumper:!0,showPageSize:!0,pageSizeOptions:[20,50,100,200,300,500]}));te(()=>{q()});const c=async()=>{h.value=!0;try{const e=await P.postForm("/api/admin/user/list",U(i));u.page=e.page,u.results=e.results}finally{h.value=!1}};c();const F=(e,l)=>{e==="edit"?w.value.showEdit(l.id):e==="resetPassword"&&B(l)},b=e=>E(`/user/${e.idEncode||e.id}`),B=e=>{ce.confirm({title:m("pages.user.resetPassword.confirmTitle"),content:m("pages.user.resetPassword.confirmContent",{nickname:e.nickname}),okText:m("common.confirm"),cancelText:m("common.cancel"),onOk:async()=>{try{const l=await P.postForm("/api/admin/user/reset_password",U({userId:e.id}));v.value.show(l.password)}catch(l){_e.error(l.message||m("pages.user.resetPassword.failed"))}}})},A=e=>{i.page=e,c()},L=e=>{i.limit=e,c()};return(e,l)=>{const k=ae,_=fe,S=ge,O=se,R=oe,V=le,M=ne,r=be,z=ie,N=re,j=de,H=pe,T=he,G=Q,J=ue,K=me;return f(),$("div",$e,[p("div",we,[t(M,{model:o(i),layout:"inline",size:o(g).table.size},{default:s(()=>[t(_,null,{default:s(()=>[t(k,{modelValue:o(i).id,"onUpdate:modelValue":l[0]||(l[0]=a=>o(i).id=a),placeholder:e.$t("pages.user.filter.id")},null,8,["modelValue","placeholder"])]),_:1}),t(_,null,{default:s(()=>[t(k,{modelValue:o(i).username,"onUpdate:modelValue":l[1]||(l[1]=a=>o(i).username=a),placeholder:e.$t("pages.user.filter.username")},null,8,["modelValue","placeholder"])]),_:1}),t(_,null,{default:s(()=>[t(k,{modelValue:o(i).nickname,"onUpdate:modelValue":l[2]||(l[2]=a=>o(i).nickname=a),placeholder:e.$t("pages.user.filter.nickname")},null,8,["modelValue","placeholder"])]),_:1}),t(_,null,{default:s(()=>[t(O,{modelValue:o(i).type,"onUpdate:modelValue":l[3]||(l[3]=a=>o(i).type=a),placeholder:e.$t("pages.user.filter.type"),"allow-clear":""},{default:s(()=>[t(S,{value:0,label:e.$t("pages.user.filter.typeUser")},null,8,["label"]),t(S,{value:1,label:e.$t("pages.user.filter.typeStaff")},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1}),t(_,null,{default:s(()=>[t(V,{type:"primary","html-type":"submit",onClick:c},{icon:s(()=>[t(R)]),default:s(()=>[d(" "+n(e.$t("pages.user.filter.search")),1)]),_:1})]),_:1})]),_:1},8,["model","size"]),l[4]||(l[4]=p("div",{class:"action-btns"},null,-1))]),p("div",ve,[t(K,{loading:o(h),data:o(u).results,size:o(g).table.size,bordered:o(g).table.bordered,pagination:o(D),"sticky-header":!0,style:{height:"100%"},"column-resizable":"",onPageChange:A,onPageSizeChange:L},{columns:s(()=>[t(r,{title:e.$t("pages.user.table.id"),"data-index":"id"},{cell:s(({record:a})=>[d(n(a.id),1)]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.idEncode"),"data-index":"idEncode"},{cell:s(({record:a})=>[p("a",{href:b(a),target:"_blank",class:"text-link"},n(a.idEncode||"-"),9,Se)]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.type"),"data-index":"type"},{cell:s(({record:a})=>[a.type===1?(f(),C(z,{key:0,color:"blue"},{default:s(()=>[d(n(e.$t("pages.user.filter.typeStaff")),1)]),_:1})):(f(),C(z,{key:1},{default:s(()=>[d(n(e.$t("pages.user.filter.typeUser")),1)]),_:1}))]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.avatar"),"data-index":"avatar"},{cell:s(({record:a})=>[p("a",{href:b(a),target:"_blank"},[t(N,null,{default:s(()=>[a.avatar?(f(),$("img",{key:0,src:("useSiteURL"in e?e.useSiteURL:o(E))(a.avatar)},null,8,ze)):(f(),$("span",Te,n(a.nickname),1))]),_:2},1024)],8,Ve)]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.username"),"data-index":"username"},{cell:s(({record:a})=>[p("a",{href:b(a),target:"_blank",class:"text-link"},n(a.username||"-"),9,Pe)]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.nickname"),"data-index":"nickname"},{cell:s(({record:a})=>[p("a",{href:b(a),target:"_blank",class:"text-link"},n(a.nickname),9,Ue)]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.email"),"data-index":"email"},null,8,["title"]),t(r,{title:e.$t("pages.user.table.score"),"data-index":"score"},null,8,["title"]),t(r,{title:e.$t("pages.user.table.level"),"data-index":"level"},null,8,["title"]),t(r,{title:e.$t("pages.user.table.forbidden"),"data-index":"forbidden"},{cell:s(({record:a})=>[d(n(a.forbidden?e.$t("pages.user.table.forbiddenYes"):e.$t("pages.user.table.forbiddenNo")),1)]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.createTime"),"data-index":"createTime"},{cell:s(({record:a})=>[d(n(("useFormatDate"in e?e.useFormatDate:o(Z))(a.createTime)),1)]),_:1},8,["title"]),t(r,{title:e.$t("pages.user.table.action"),width:120,align:"center"},{cell:s(({record:a})=>[t(J,{onSelect:W=>F(W,a)},{content:s(()=>[t(T,{value:"edit"},{icon:s(()=>[t(H)]),default:s(()=>[d(" "+n(e.$t("pages.user.table.edit")),1)]),_:1}),t(T,{value:"resetPassword"},{icon:s(()=>[t(G)]),default:s(()=>[d(" "+n(e.$t("pages.user.table.resetPassword")),1)]),_:1})]),default:s(()=>[t(V,{size:o(g).table.size},{default:s(()=>[d(n(e.$t("pages.user.table.actions"))+" ",1),t(j)]),_:1},8,["size"])]),_:2},1032,["onSelect"])]),_:1},8,["title"])]),_:1},8,["loading","data","size","bordered","pagination"])]),t(ke,{ref_key:"edit",ref:w,onOk:c},null,512),t(ye,{ref_key:"showPassword",ref:v},null,512)])}}});export{et as default};
