import{v as G,f as H,a as b,C as v}from"./index.51e009fb.js";/* empty css              *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css               */import{d as M,j as C,r as A,c as J,b6 as K,bE as L,bH as x,aU as P,ba as Q,aE as f,aH as s,u as a,b1 as W,C as p,aI as t,D as V,aJ as k,aM as w,b7 as X,bG as Y}from"./arco.c0e72183.js";const ue=M({__name:"Edit",props:{eventTypeOptions:{},groupOptions:{}},emits:["ok"],setup(F,{expose:I,emit:O}){const q=O,{t:T}=G.exports.useI18n(),B=F,E=H(),y=C(),u=A({visible:!1,isCreate:!1,title:""}),o=C({id:void 0,groupName:"",title:"",description:"",eventType:void 0,period:0,maxFinishCount:1,eventCount:1,score:0,exp:0,badgeId:0,btnName:"",actionUrl:"",sortNo:0,status:0}),N=C([]),U=async()=>{const n=await b.postForm("/api/admin/badge/list",v({page:1,limit:500,status:0}));N.value=(n.results||[]).map(l=>({id:l.id,title:l.title}))},_={title:[{required:!0}],groupName:[{required:!0}],eventType:[{required:!0}],period:[{required:!0}],eventCount:[{required:!0,type:"number",min:1}],maxFinishCount:[{required:!0,type:"number",min:1}]},$=J(()=>{var n,l;return((l=(n=B.groupOptions)==null?void 0:n[0])==null?void 0:l.key)||""}),c=async()=>{u.visible=!0,u.isCreate=!0,u.title=T("pages.growthTaskConfig.add"),o.value={id:void 0,groupName:$.value,title:"",description:"",eventType:void 0,period:0,maxFinishCount:1,eventCount:1,score:0,exp:0,badgeId:0,btnName:"",actionUrl:"",sortNo:0,status:0},await U()},h=async n=>{u.visible=!0,u.isCreate=!1,u.title=T("pages.growthTaskConfig.edit"),await U();const l=await b.get(`/api/admin/task-config/${n}`),{startTime:r,endTime:i,...d}=l||{};o.value={groupName:$.value,...d}},z=async n=>{if(await y.value.validate()){n(!1);return}const r={...o.value};r.badgeId||(r.badgeId=0),u.isCreate?await b.postForm("/api/admin/task-config/create",v(r)):await b.postForm("/api/admin/task-config/update",v(r)),q("ok"),n(!0)},D=()=>{u.visible=!1};return I({show:c,showEdit:h}),(n,l)=>{const r=K,i=X,d=Y,m=L,R=x,g=P,j=Q,S=W;return p(),f(S,{visible:a(u).visible,"onUpdate:visible":l[14]||(l[14]=e=>a(u).visible=e),title:a(u).title,size:a(E).table.size,onCancel:D,onBeforeOk:z},{default:s(()=>[t(j,{ref_key:"formRef",ref:y,model:a(o),rules:_},{default:s(()=>[t(i,{label:n.$t("pages.growthTaskConfig.title"),field:"title"},{default:s(()=>[t(r,{modelValue:a(o).title,"onUpdate:modelValue":l[0]||(l[0]=e=>a(o).title=e)},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.groupName"),field:"groupName"},{default:s(()=>[t(m,{modelValue:a(o).groupName,"onUpdate:modelValue":l[1]||(l[1]=e=>a(o).groupName=e)},{default:s(()=>[(p(!0),V(w,null,k(n.groupOptions,e=>(p(),f(d,{key:e.key,value:e.key,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.description"),field:"description"},{default:s(()=>[t(R,{modelValue:a(o).description,"onUpdate:modelValue":l[2]||(l[2]=e=>a(o).description=e),"auto-size":{minRows:2,maxRows:4}},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.eventType"),field:"eventType"},{default:s(()=>[t(m,{modelValue:a(o).eventType,"onUpdate:modelValue":l[3]||(l[3]=e=>a(o).eventType=e),"allow-clear":""},{default:s(()=>[(p(!0),V(w,null,k(n.eventTypeOptions,e=>(p(),f(d,{key:e.value,value:e.value,label:e.title||e.value},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.period"),field:"period"},{default:s(()=>[t(m,{modelValue:a(o).period,"onUpdate:modelValue":l[4]||(l[4]=e=>a(o).period=e)},{default:s(()=>[t(d,{value:0,label:n.$t("pages.growthTaskConfig.periodOnce")},null,8,["label"]),t(d,{value:1,label:n.$t("pages.growthTaskConfig.periodDaily")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.eventCount"),field:"eventCount"},{default:s(()=>[t(g,{modelValue:a(o).eventCount,"onUpdate:modelValue":l[5]||(l[5]=e=>a(o).eventCount=e),min:1,mode:"button"},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.maxFinishCount"),field:"maxFinishCount"},{default:s(()=>[t(g,{modelValue:a(o).maxFinishCount,"onUpdate:modelValue":l[6]||(l[6]=e=>a(o).maxFinishCount=e),min:1,mode:"button"},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.score"),field:"score"},{default:s(()=>[t(g,{modelValue:a(o).score,"onUpdate:modelValue":l[7]||(l[7]=e=>a(o).score=e),min:0,mode:"button"},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.exp"),field:"exp"},{default:s(()=>[t(g,{modelValue:a(o).exp,"onUpdate:modelValue":l[8]||(l[8]=e=>a(o).exp=e),min:0,mode:"button"},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.badgeId"),field:"badgeId"},{default:s(()=>[t(m,{modelValue:a(o).badgeId,"onUpdate:modelValue":l[9]||(l[9]=e=>a(o).badgeId=e),"allow-clear":""},{default:s(()=>[t(d,{value:0,label:n.$t("pages.growthTaskConfig.badgeNone")},null,8,["label"]),(p(!0),V(w,null,k(a(N),e=>(p(),f(d,{key:e.id,value:e.id,label:`${e.title} (#${e.id})`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.btnName"),field:"btnName"},{default:s(()=>[t(r,{modelValue:a(o).btnName,"onUpdate:modelValue":l[10]||(l[10]=e=>a(o).btnName=e)},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.actionUrl"),field:"actionUrl"},{default:s(()=>[t(r,{modelValue:a(o).actionUrl,"onUpdate:modelValue":l[11]||(l[11]=e=>a(o).actionUrl=e)},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.sortNo"),field:"sortNo"},{default:s(()=>[t(g,{modelValue:a(o).sortNo,"onUpdate:modelValue":l[12]||(l[12]=e=>a(o).sortNo=e),min:0,mode:"button"},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{label:n.$t("pages.growthTaskConfig.status"),field:"status"},{default:s(()=>[t(m,{modelValue:a(o).status,"onUpdate:modelValue":l[13]||(l[13]=e=>a(o).status=e)},{default:s(()=>[t(d,{value:0,label:n.$t("pages.growthTaskConfig.statusOk")},null,8,["label"]),t(d,{value:1,label:n.$t("pages.growthTaskConfig.statusDeleted")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["visible","title","size"])}}});export{ue as _};
