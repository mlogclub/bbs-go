import{_ as $,v as j,F as E,a as u,B as T,C as V,h as D}from"./index.e2988b1b.js";/* empty css              *//* empty css                *//* empty css                *//* empty css                */import{j as l,o as H,aY as L,aX as Y,S as z,bN as K,bY as P,bb as A,D as v,E as c,aI as o,aH as r,C as _,aK as k,aL as y,aM as J,aJ as U,F as X,u as a,aE as q,e as G,aF as O}from"./arco.b0f81cee.js";import"./chart.37105098.js";import"./vue.76373e4c.js";const Q={class:"container"},W={class:"container-header"},Z={style:{width:"max-content"}},ee={class:"container-main"},ae={class:"role-item-list"},se=["onClick"],te={__name:"index",setup(ne){const{t:w}=j.exports.useI18n(),p=l(!1),i=l([]),d=l([]),s=l(),t=l([]),g={overflowY:"auto",height:"calc(100% - 46px)"};H(()=>{E(),b()});const b=async()=>{await Promise.all([C(),B()]),s.value||i.value&&i.value.length&&(s.value=i.value[0].id),await m()},I=async e=>{s.value=e.id,await m()},x=async()=>{try{await u.postForm("/api/admin/role/save_role_menus",T({roleId:s.value,menuIds:t.value?t.value.join(","):""})),V(w("pages.permission.saveSuccess"))}catch(e){D(e)}await m()},C=async()=>{i.value=await u.get("/api/admin/role/all_roles")},B=async()=>{try{p.value=!0,d.value=await u.get("/api/admin/menu/tree")}finally{p.value=!1}},m=async()=>{t.value=await u.get(`/api/admin/role/role_menu_ids?roleId=${s.value}`)};return(e,h)=>{const R=L,F=Y,M=z,f=K,N=P,S=A;return _(),v("div",Q,[c("div",W,[c("div",Z,[o(R,{type:"warning"},{default:r(()=>[k(y(e.$t("pages.permission.tips")),1)]),_:1})]),o(F,{type:"primary",onClick:x},{default:r(()=>[k(y(e.$t("pages.permission.save")),1)]),_:1})]),c("div",ee,[o(f,{title:e.$t("pages.permission.roleList"),class:"roles-panel","body-style":g},{default:r(()=>[c("div",ae,[(_(!0),v(J,null,U(a(i),n=>(_(),v("div",{key:n.id,class:X(["role-item",{active:n.id===a(s)}]),onClick:oe=>I(n)},[c("span",null,y(n.name),1),o(M)],10,se))),128))])]),_:1},8,["title"]),o(f,{title:e.$t("pages.permission.menuPermission"),class:"menus-panel","body-style":g},{default:r(()=>[o(S,{loading:a(p),dot:"",style:{width:"100%"}},{default:r(()=>[a(d)&&a(d).length?(_(),q(N,{key:0,"checked-keys":a(t),"onUpdate:checkedKeys":h[0]||(h[0]=n=>G(t)?t.value=n:null),data:a(d),checkable:!0,"default-expand-all":!0,size:"large"},null,8,["checked-keys","data"])):O("",!0)]),_:1},8,["loading"])]),_:1},8,["title"])])])}}},me=$(te,[["__scopeId","data-v-24e0be81"]]);export{me as default};
