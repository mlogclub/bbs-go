import{_ as N,v as j,C as E,a as u,z as H,A as T,B as V}from"./index.1ef40fc2.js";/* empty css              *//* empty css                *//* empty css                *//* empty css                */import{j as l,o as z,aY as D,aX as L,S as A,bH as K,bW as P,bb as Y,D as v,E as c,aI as o,aH as r,C as _,aK as k,aL as y,aM as J,aJ as U,F as W,u as a,aE as X,e as q,aF as G}from"./arco.91fbb644.js";import"./chart.905cd90f.js";import"./vue.481dfdbf.js";const O={class:"container"},Q={class:"container-header"},Z={style:{width:"max-content"}},ee={class:"container-main"},ae={class:"role-item-list"},se=["onClick"],te={__name:"index",setup(ne){const{t:w}=j.exports.useI18n(),p=l(!1),i=l([]),d=l([]),s=l(),t=l([]),g={overflowY:"auto",height:"calc(100% - 46px)"};z(()=>{E(),b()});const b=async()=>{await Promise.all([C(),B()]),s.value||i.value&&i.value.length&&(s.value=i.value[0].id),await m()},I=async e=>{s.value=e.id,await m()},x=async()=>{try{await u.postForm("/api/admin/role/save_role_menus",H({roleId:s.value,menuIds:t.value?t.value.join(","):""})),T(w("pages.permission.saveSuccess"))}catch(e){V(e)}await m()},C=async()=>{i.value=await u.get("/api/admin/role/all_roles")},B=async()=>{try{p.value=!0,d.value=await u.get("/api/admin/menu/tree")}finally{p.value=!1}},m=async()=>{t.value=await u.get(`/api/admin/role/role_menu_ids?roleId=${s.value}`)};return(e,h)=>{const R=D,M=L,S=A,f=K,$=P,F=Y;return _(),v("div",O,[c("div",Q,[c("div",Z,[o(R,{type:"warning"},{default:r(()=>[k(y(e.$t("pages.permission.tips")),1)]),_:1})]),o(M,{type:"primary",onClick:x},{default:r(()=>[k(y(e.$t("pages.permission.save")),1)]),_:1})]),c("div",ee,[o(f,{title:e.$t("pages.permission.roleList"),class:"roles-panel","body-style":g},{default:r(()=>[c("div",ae,[(_(!0),v(J,null,U(a(i),n=>(_(),v("div",{key:n.id,class:W(["role-item",{active:n.id===a(s)}]),onClick:oe=>I(n)},[c("span",null,y(n.name),1),o(S)],10,se))),128))])]),_:1},8,["title"]),o(f,{title:e.$t("pages.permission.menuPermission"),class:"menus-panel","body-style":g},{default:r(()=>[o(F,{loading:a(p),dot:"",style:{width:"100%"}},{default:r(()=>[a(d)&&a(d).length?(_(),X($,{key:0,"checked-keys":a(t),"onUpdate:checkedKeys":h[0]||(h[0]=n=>q(t)?t.value=n:null),data:a(d),checkable:!0,"default-expand-all":!0,size:"large"},null,8,["checked-keys","data"])):G("",!0)]),_:1},8,["loading"])]),_:1},8,["title"])])])}}},me=N(te,[["__scopeId","data-v-24e0be81"]]);export{me as default};
