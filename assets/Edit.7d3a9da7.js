import{_ as ae,g as le,b as h,A as F,y as oe,z as ne}from"./index.1b6e845e.js";/* empty css                *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css                *//* empty css                */import{e as m,r as se,c as ie,bR as de,bE as ue,b4 as me,bA as pe,a4 as re,aV as ce,b7 as _e,bI as fe,a5 as ve,b8 as be,ab as ye,aX as Ve,aD as f,aG as n,u as l,B as v,aH as e,aE as w,aJ as I,F as g,aK as z,j as B,b5 as he,bG as we,bJ as Ie,a$ as ge,ba as xe,bb as Ce}from"./arco.ef2238db.js";import ke from"./IconPicker.bd19a294.js";import"./chart.ba8df0e9.js";import"./vue.f27dce51.js";/* empty css               */const Ne=b=>(xe("data-v-8f534f9e"),b=b(),Ce(),b),Se={class:"api-panel"},Ue={class:"api-btns"},Ee=Ne(()=>g("span",null,"\u6DFB\u52A0",-1)),Fe={style:{"margin-bottom":"10px"}},ze={__name:"Edit",emits:["ok"],setup(b,{expose:D,emit:A}){const T=A,M=le(),p=m(),d=se({visible:!1,isCreate:!1,title:""}),a=m({id:void 0,type:"menu",parentId:void 0,name:void 0,title:void 0,icon:void 0,path:void 0,status:0,apis:[]}),R={type:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B"}],title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},C=m([]),k=async()=>{C.value=await h.get("/api/admin/menu/tree")},L=async()=>{a.value.id=void 0,a.value.apis=[],p.value.resetFields(),d.isCreate=!0,d.title="\u65B0\u589E",await k(),d.visible=!0},O=async s=>{p.value.resetFields(),d.isCreate=!1,d.title="\u7F16\u8F91",await k();try{a.value=await h.get(`/api/admin/menu/${s}`)}catch(t){F(t)}d.visible=!0},P=()=>{p.value.resetFields()},q=async s=>{if(await p.value.validate()){s(!1);return}try{const i=d.isCreate?"/api/admin/menu/create":"/api/admin/menu/update";await h.postForm(i,oe(a.value)),ne("\u63D0\u4EA4\u6210\u529F"),T("ok"),s(!0)}catch(i){F(i),s(!1)}},$=[{title:"Method",dataIndex:"method",slotName:"method",width:100},{title:"Path",dataIndex:"path",slotName:"path"},{title:"Name",dataIndex:"name",slotName:"name"},{title:"",dataIndex:"operation",slotName:"operation",width:30}],r=m(!1),c=m(""),x=m([]),j=ie(()=>{const s=c.value?c.value.trim().toLowerCase():"";if(!s)return x.value;const t=[];return x.value.forEach(i=>{(i.path.toLowerCase().includes(s)||i.name.toLowerCase().includes(s))&&t.push(i)}),t}),G=(s,t)=>{var i;(i=a.value.apis)==null||i.splice(t,1)},H=async()=>{x.value=await h.get("/api/admin/api/list_all"),r.value=!0},J=s=>{var t;!a.value.apis||!a.value.apis.length?a.value.apis=[s]:(t=a.value.apis)==null||t.push(s),r.value=!1};return D({show:L,showEdit:O}),(s,t)=>{const i=de,u=he,y=we,N=ue,_=me,S=pe,K=re,U=ce,X=_e,E=fe,Q=ve,W=be,Y=ye,V=Ie,Z=ge,ee=Ve;return v(),f(ee,{visible:l(d).visible,"onUpdate:visible":t[10]||(t[10]=o=>l(d).visible=o),title:l(d).title,size:l(M).table.size,width:780,onCancel:P,onBeforeOk:q},{default:n(()=>[e(W,{ref_key:"formRef",ref:p,layout:"vertical",model:l(a),rules:R},{default:n(()=>[e(u,{label:"\u4E0A\u7EA7",field:"parentId"},{default:n(()=>[e(i,{modelValue:l(a).parentId,"onUpdate:modelValue":t[0]||(t[0]=o=>l(a).parentId=o),"allow-clear":"",data:l(C),placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7"},null,8,["modelValue","data"])]),_:1}),e(u,{label:"\u7C7B\u578B",field:"type"},{default:n(()=>[e(N,{modelValue:l(a).type,"onUpdate:modelValue":t[1]||(t[1]=o=>l(a).type=o),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:n(()=>[e(y,{value:"menu",label:"\u83DC\u5355"}),e(y,{value:"func",label:"\u529F\u80FD"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"\u6807\u9898",field:"title"},{default:n(()=>[e(_,{modelValue:l(a).title,"onUpdate:modelValue":t[2]||(t[2]=o=>l(a).title=o)},null,8,["modelValue"])]),_:1}),l(a).type==="menu"?(v(),f(u,{key:0,label:"\u540D\u79F0",field:"name"},{default:n(()=>[e(_,{modelValue:l(a).name,"onUpdate:modelValue":t[3]||(t[3]=o=>l(a).name=o),placeholder:"\u7EC4\u4EF6/\u529F\u80FD\u540D\u79F0\uFF0C\u5168\u5C40\u552F\u4E00"},null,8,["modelValue"])]),_:1})):w("",!0),l(a).type==="menu"?(v(),f(u,{key:1,label:"\u7EC4\u4EF6",field:"component"},{default:n(()=>[e(_,{modelValue:l(a).component,"onUpdate:modelValue":t[4]||(t[4]=o=>l(a).component=o)},null,8,["modelValue"])]),_:1})):w("",!0),l(a).type==="menu"?(v(),f(u,{key:2,label:"\u8DEF\u5F84",field:"path"},{default:n(()=>[e(_,{modelValue:l(a).path,"onUpdate:modelValue":t[5]||(t[5]=o=>l(a).path=o)},null,8,["modelValue"])]),_:1})):w("",!0),l(a).type==="menu"?(v(),f(u,{key:3,label:"ICON",field:"icon"},{default:n(()=>[e(ke,{modelValue:l(a).icon,"onUpdate:modelValue":t[6]||(t[6]=o=>l(a).icon=o)},null,8,["modelValue"])]),_:1})):w("",!0),e(u,{label:"\u72B6\u6001",field:"status"},{default:n(()=>[e(N,{modelValue:l(a).status,"onUpdate:modelValue":t[7]||(t[7]=o=>l(a).status=o)},{default:n(()=>[e(y,{value:0},{default:n(()=>[I("\u6B63\u5E38")]),_:1}),e(y,{value:1},{default:n(()=>[I("\u7981\u7528")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"\u63A5\u53E3"},{default:n(()=>[g("div",Se,[e(E,{class:"api-table",size:"small",columns:$,data:l(a).apis,pagination:!1},{method:n(({record:o})=>[e(S,null,{default:n(()=>[I(z(o.method),1)]),_:2},1024)]),operation:n(({record:o,rowIndex:te})=>[e(X,null,{default:n(()=>[e(U,{type:"primary",status:"danger",shape:"circle",size:"mini"},{default:n(()=>[e(K,{onClick:Be=>G(o,te)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["data"]),g("div",Ue,[e(U,{type:"primary",size:"mini",onClick:H},{default:n(()=>[e(Q),Ee]),_:1})])])]),_:1})]),_:1},8,["model"]),e(Z,{visible:l(r),"onUpdate:visible":t[9]||(t[9]=o=>B(r)?r.value=o:null),width:950,height:"300"},{default:n(()=>[g("div",Fe,[e(_,{modelValue:l(c),"onUpdate:modelValue":t[8]||(t[8]=o=>B(c)?c.value=o:null),placeholder:"\u641C\u7D22\u63A5\u53E3"},{suffix:n(()=>[e(Y)]),_:1},8,["modelValue"])]),e(E,{data:l(j),pagination:!1,"show-empty-tree":"","column-resizable":"","row-key":"id",scroll:{y:500},onRowClick:J},{columns:n(()=>[e(V,{title:"ID","data-index":"id",width:80}),e(V,{title:"Method","data-index":"method",width:80},{cell:n(({record:o})=>[e(S,null,{default:n(()=>[I(z(o.method),1)]),_:2},1024)]),_:1}),e(V,{title:"Path","data-index":"path"}),e(V,{title:"Name","data-index":"name"})]),_:1},8,["data"])]),_:1},8,["visible"])]),_:1},8,["visible","title","size"])}}},Ze=ae(ze,[["__scopeId","data-v-8f534f9e"]]);export{Ze as default};
