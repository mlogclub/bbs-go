import{_ as te,f as ae,a as V,A as F,y as le,z as oe}from"./index.f21f3c04.js";/* empty css                *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css                *//* empty css                */import{j as m,r as ne,c as ie,bR as se,bE as de,b6 as ue,bA as me,a5 as pe,aX as re,b9 as ce,bI as fe,a6 as _e,ba as ve,ac as be,aZ as ye,aE as _,aH as n,u as l,C as v,aI as t,aF as w,aK as h,E as C,aL as z,e as S,b7 as Ve,bG as we,bJ as he,b1 as Ce}from"./arco.8a931ad5.js";import Ie from"./IconPicker.aad7872f.js";import"./chart.71b0189b.js";import"./vue.a0233a03.js";/* empty css               */const ge={class:"api-panel"},xe={class:"api-btns"},ke={style:{"margin-bottom":"10px"}},Ne={__name:"Edit",emits:["ok"],setup(Ee,{expose:A,emit:B}){const D=B,T=ae(),p=m(),d=ne({visible:!1,isCreate:!1,title:""}),a=m({id:void 0,type:"menu",parentId:void 0,name:void 0,title:void 0,icon:void 0,path:void 0,status:0,apis:[]}),L={type:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B"}],title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},g=m([]),x=async()=>{g.value=await V.get("/api/admin/menu/tree")},M=async()=>{a.value.id=void 0,a.value.apis=[],p.value.resetFields(),d.isCreate=!0,d.title="\u65B0\u589E",await x(),d.visible=!0},R=async i=>{p.value.resetFields(),d.isCreate=!1,d.title="\u7F16\u8F91",await x();try{a.value=await V.get(`/api/admin/menu/${i}`)}catch(e){F(e)}d.visible=!0},O=()=>{p.value.resetFields()},P=async i=>{if(await p.value.validate()){i(!1);return}try{const s=d.isCreate?"/api/admin/menu/create":"/api/admin/menu/update";await V.postForm(s,le(a.value)),oe("\u63D0\u4EA4\u6210\u529F"),D("ok"),i(!0)}catch(s){F(s),i(!1)}},q=[{title:"Method",dataIndex:"method",slotName:"method",width:100},{title:"Path",dataIndex:"path",slotName:"path"},{title:"Name",dataIndex:"name",slotName:"name"},{title:"",dataIndex:"operation",slotName:"operation",width:30}],r=m(!1),c=m(""),I=m([]),j=ie(()=>{const i=c.value?c.value.trim().toLowerCase():"";if(!i)return I.value;const e=[];return I.value.forEach(s=>{(s.path.toLowerCase().includes(i)||s.name.toLowerCase().includes(i))&&e.push(s)}),e}),H=(i,e)=>{var s;(s=a.value.apis)==null||s.splice(e,1)},$=async()=>{I.value=await V.get("/api/admin/api/list_all"),r.value=!0},G=i=>{var e;!a.value.apis||!a.value.apis.length?a.value.apis=[i]:(e=a.value.apis)==null||e.push(i),r.value=!1};return A({show:M,showEdit:R}),(i,e)=>{const s=se,u=Ve,b=we,k=de,f=ue,N=me,J=pe,E=re,K=ce,U=fe,X=_e,Z=ve,Q=be,y=he,W=Ce,Y=ye;return v(),_(Y,{visible:l(d).visible,"onUpdate:visible":e[10]||(e[10]=o=>l(d).visible=o),title:l(d).title,size:l(T).table.size,width:780,onCancel:O,onBeforeOk:P},{default:n(()=>[t(Z,{ref_key:"formRef",ref:p,layout:"vertical",model:l(a),rules:L},{default:n(()=>[t(u,{label:"\u4E0A\u7EA7",field:"parentId"},{default:n(()=>[t(s,{modelValue:l(a).parentId,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).parentId=o),"allow-clear":"",data:l(g),placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7"},null,8,["modelValue","data"])]),_:1}),t(u,{label:"\u7C7B\u578B",field:"type"},{default:n(()=>[t(k,{modelValue:l(a).type,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).type=o),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:n(()=>[t(b,{value:"menu",label:"\u83DC\u5355"}),t(b,{value:"func",label:"\u529F\u80FD"})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"\u6807\u9898",field:"title"},{default:n(()=>[t(f,{modelValue:l(a).title,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).title=o)},null,8,["modelValue"])]),_:1}),l(a).type==="menu"?(v(),_(u,{key:0,label:"\u540D\u79F0",field:"name"},{default:n(()=>[t(f,{modelValue:l(a).name,"onUpdate:modelValue":e[3]||(e[3]=o=>l(a).name=o),placeholder:"\u7EC4\u4EF6/\u529F\u80FD\u540D\u79F0\uFF0C\u5168\u5C40\u552F\u4E00"},null,8,["modelValue"])]),_:1})):w("",!0),l(a).type==="menu"?(v(),_(u,{key:1,label:"\u7EC4\u4EF6",field:"component"},{default:n(()=>[t(f,{modelValue:l(a).component,"onUpdate:modelValue":e[4]||(e[4]=o=>l(a).component=o)},null,8,["modelValue"])]),_:1})):w("",!0),l(a).type==="menu"?(v(),_(u,{key:2,label:"\u8DEF\u5F84",field:"path"},{default:n(()=>[t(f,{modelValue:l(a).path,"onUpdate:modelValue":e[5]||(e[5]=o=>l(a).path=o)},null,8,["modelValue"])]),_:1})):w("",!0),l(a).type==="menu"?(v(),_(u,{key:3,label:"ICON",field:"icon"},{default:n(()=>[t(Ie,{modelValue:l(a).icon,"onUpdate:modelValue":e[6]||(e[6]=o=>l(a).icon=o)},null,8,["modelValue"])]),_:1})):w("",!0),t(u,{label:"\u72B6\u6001",field:"status"},{default:n(()=>[t(k,{modelValue:l(a).status,"onUpdate:modelValue":e[7]||(e[7]=o=>l(a).status=o)},{default:n(()=>[t(b,{value:0},{default:n(()=>e[11]||(e[11]=[h("\u6B63\u5E38")])),_:1}),t(b,{value:1},{default:n(()=>e[12]||(e[12]=[h("\u7981\u7528")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"\u63A5\u53E3"},{default:n(()=>[C("div",ge,[t(U,{class:"api-table",size:"small",columns:q,data:l(a).apis,pagination:!1},{method:n(({record:o})=>[t(N,null,{default:n(()=>[h(z(o.method),1)]),_:2},1024)]),operation:n(({record:o,rowIndex:ee})=>[t(K,null,{default:n(()=>[t(E,{type:"primary",status:"danger",shape:"circle",size:"mini"},{default:n(()=>[t(J,{onClick:Ue=>H(o,ee)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["data"]),C("div",xe,[t(E,{type:"primary",size:"mini",onClick:$},{default:n(()=>[t(X),e[13]||(e[13]=C("span",null,"\u6DFB\u52A0",-1))]),_:1})])])]),_:1})]),_:1},8,["model"]),t(W,{visible:l(r),"onUpdate:visible":e[9]||(e[9]=o=>S(r)?r.value=o:null),width:950,height:"300"},{default:n(()=>[C("div",ke,[t(f,{modelValue:l(c),"onUpdate:modelValue":e[8]||(e[8]=o=>S(c)?c.value=o:null),placeholder:"\u641C\u7D22\u63A5\u53E3"},{suffix:n(()=>[t(Q)]),_:1},8,["modelValue"])]),t(U,{data:l(j),pagination:!1,"show-empty-tree":"","column-resizable":"","row-key":"id",scroll:{y:500},onRowClick:G},{columns:n(()=>[t(y,{title:"ID","data-index":"id",width:80}),t(y,{title:"Method","data-index":"method",width:80},{cell:n(({record:o})=>[t(N,null,{default:n(()=>[h(z(o.method),1)]),_:2},1024)]),_:1}),t(y,{title:"Path","data-index":"path"}),t(y,{title:"Name","data-index":"name"})]),_:1},8,["data"])]),_:1},8,["visible"])]),_:1},8,["visible","title","size"])}}},Xe=te(Ne,[["__scopeId","data-v-8f534f9e"]]);export{Xe as default};
