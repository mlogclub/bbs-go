import{_ as te,v as le,f as ne,a as V,B as T,z as oe,A as se}from"./index.91a3ffa1.js";/* empty css                *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css                *//* empty css                */import{j as d,r as ie,c as ue,bU as pe,bE as de,b6 as me,bA as re,a5 as ce,aX as fe,b9 as _e,bI as be,a6 as ve,ba as ge,ac as ye,aZ as he,aE as b,aH as s,u as n,C as v,aI as a,aF as w,aK as $,aL as g,E as I,e as z,b7 as Ve,bG as we,bJ as $e,b1 as Ie}from"./arco.d63f31ab.js";import Ce from"./IconPicker.bf1c2bcd.js";import"./chart.fcbefee0.js";import"./vue.576003d6.js";/* empty css               */const ke={class:"api-panel"},Se={class:"api-btns"},Ne={style:{"margin-bottom":"10px"}},Ue={__name:"Edit",emits:["ok"],setup(Ee,{expose:A,emit:B}){const D=B,{t:m}=le.exports.useI18n(),M=ne(),r=d(),u=ie({visible:!1,isCreate:!1,title:""}),l=d({id:void 0,type:"menu",parentId:void 0,name:void 0,title:void 0,icon:void 0,path:void 0,status:0,apis:[]}),P={type:[{required:!0,message:m("pages.menu.pleaseSelectType")}],title:[{required:!0,message:m("pages.menu.pleaseInputTitle")}]},k=d([]),S=async()=>{k.value=await V.get("/api/admin/menu/tree")},L=async()=>{l.value.id=void 0,l.value.apis=[],r.value.resetFields(),u.isCreate=!0,u.title=m("pages.menu.new"),await S(),u.visible=!0},R=async e=>{r.value.resetFields(),u.isCreate=!1,u.title=m("pages.menu.editTitle"),await S();try{l.value=await V.get(`/api/admin/menu/${e}`)}catch(t){T(t)}u.visible=!0},j=()=>{r.value.resetFields()},q=async e=>{if(await r.value.validate()){e(!1);return}try{const i=u.isCreate?"/api/admin/menu/create":"/api/admin/menu/update";await V.postForm<any>oe(l.value),se(m("pages.menu.submitSuccess")),D("ok"),e(!0)}catch(i){T(i),e(!1)}},O=[{title:"Method",dataIndex:"method",slotName:"method",width:100},{title:"Path",dataIndex:"path",slotName:"path"},{title:"Name",dataIndex:"name",slotName:"name"},{title:"",dataIndex:"operation",slotName:"operation",width:30}],c=d(!1),f=d(""),C=d([]),H=ue(()=>{const e=f.value?f.value.trim().toLowerCase():"";if(!e)return C.value;const t=[];return C.value.forEach(i=>{(i.path.toLowerCase().includes(e)||i.name.toLowerCase().includes(e))&&t.push(i)}),t}),G=(e,t)=>{var i;(i=l.value.apis)==null||i.splice(t,1)},J=async()=>{C.value=await V.get("/api/admin/api/list_all"),c.value=!0},K=e=>{var t;!l.value.apis||!l.value.apis.length?l.value.apis=[e]:(t=l.value.apis)==null||t.push(e),c.value=!1};return A({show:L,showEdit:R}),(e,t)=>{const i=pe,p=Ve,y=we,N=de,_=me,U=re,X=ce,E=fe,Z=_e,F=be,Q=ve,W=ge,Y=ye,h=$e,x=Ie,ee=he;return v(),b(ee,{visible:n(u).visible,"onUpdate:visible":t[10]||(t[10]=o=>n(u).visible=o),title:n(u).title,size:n(M).table.size,width:780,onCancel:j,onBeforeOk:q},{default:s(()=>[a(W,{ref_key:"formRef",ref:r,layout:"vertical",model:n(l),rules:P},{default:s(()=>[a(p,{label:e.$t("pages.menu.parent"),field:"parentId"},{default:s(()=>[a(i,{modelValue:n(l).parentId,"onUpdate:modelValue":t[0]||(t[0]=o=>n(l).parentId=o),"allow-clear":"",data:n(k),placeholder:e.$t("pages.menu.pleaseSelectParent")},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),a(p,{label:e.$t("pages.menu.type"),field:"type"},{default:s(()=>[a(N,{modelValue:n(l).type,"onUpdate:modelValue":t[1]||(t[1]=o=>n(l).type=o),placeholder:e.$t("pages.menu.pleaseSelectType")},{default:s(()=>[a(y,{value:"menu",label:e.$t("pages.menu.typeMenu")},null,8,["label"]),a(y,{value:"func",label:e.$t("pages.menu.typeFunc")},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,{label:e.$t("pages.menu.title"),field:"title"},{default:s(()=>[a(_,{modelValue:n(l).title,"onUpdate:modelValue":t[2]||(t[2]=o=>n(l).title=o)},null,8,["modelValue"])]),_:1},8,["label"]),n(l).type==="menu"?(v(),b(p,{key:0,label:e.$t("pages.menu.name"),field:"name"},{default:s(()=>[a(_,{modelValue:n(l).name,"onUpdate:modelValue":t[3]||(t[3]=o=>n(l).name=o),placeholder:e.$t("pages.menu.namePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),n(l).type==="menu"?(v(),b(p,{key:1,label:e.$t("pages.menu.component"),field:"component"},{default:s(()=>[a(_,{modelValue:n(l).component,"onUpdate:modelValue":t[4]||(t[4]=o=>n(l).component=o)},null,8,["modelValue"])]),_:1},8,["label"])):w("",!0),n(l).type==="menu"?(v(),b(p,{key:2,label:e.$t("pages.menu.path"),field:"path"},{default:s(()=>[a(_,{modelValue:n(l).path,"onUpdate:modelValue":t[5]||(t[5]=o=>n(l).path=o)},null,8,["modelValue"])]),_:1},8,["label"])):w("",!0),n(l).type==="menu"?(v(),b(p,{key:3,label:e.$t("pages.menu.icon"),field:"icon"},{default:s(()=>[a(Ce,{modelValue:n(l).icon,"onUpdate:modelValue":t[6]||(t[6]=o=>n(l).icon=o)},null,8,["modelValue"])]),_:1},8,["label"])):w("",!0),a(p,{label:e.$t("pages.menu.status"),field:"status"},{default:s(()=>[a(N,{modelValue:n(l).status,"onUpdate:modelValue":t[7]||(t[7]=o=>n(l).status=o)},{default:s(()=>[a(y,{value:0},{default:s(()=>[$(g(e.$t("pages.menu.statusNormal")),1)]),_:1}),a(y,{value:1},{default:s(()=>[$(g(e.$t("pages.menu.statusDisabled")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(p,{label:e.$t("pages.menu.api")},{default:s(()=>[I("div",ke,[a(F,{class:"api-table",size:"small",columns:O,data:n(l).apis,pagination:!1},{method:s(({record:o})=>[a(U,null,{default:s(()=>[$(g(o.method),1)]),_:2},1024)]),operation:s(({record:o,rowIndex:ae})=>[a(Z,null,{default:s(()=>[a(E,{type:"primary",status:"danger",shape:"circle",size:"mini"},{default:s(()=>[a(X,{onClick:Fe=>G(o,ae)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["data"]),I("div",Se,[a(E,{type:"primary",size:"mini",onClick:J},{default:s(()=>[a(Q),I("span",null,g(e.$t("pages.menu.apiAdd")),1)]),_:1})])])]),_:1},8,["label"])]),_:1},8,["model"]),a(x,{visible:n(c),"onUpdate:visible":t[9]||(t[9]=o=>z(c)?c.value=o:null),width:950,height:"300"},{default:s(()=>[I("div",Ne,[a(_,{modelValue:n(f),"onUpdate:modelValue":t[8]||(t[8]=o=>z(f)?f.value=o:null),placeholder:e.$t("pages.menu.apiSearch")},{suffix:s(()=>[a(Y)]),_:1},8,["modelValue","placeholder"])]),a(F,{data:n(H),pagination:!1,"show-empty-tree":"","column-resizable":"","row-key":"id",scroll:{y:500},onRowClick:K},{columns:s(()=>[a(h,{title:e.$t("pages.menu.apiId"),"data-index":"id",width:80},null,8,["title"]),a(h,{title:e.$t("pages.menu.apiMethod"),"data-index":"method",width:80},{cell:s(({record:o})=>[a(U,null,{default:s(()=>[$(g(o.method),1)]),_:2},1024)]),_:1},8,["title"]),a(h,{title:e.$t("pages.menu.apiPath"),"data-index":"path"},null,8,["title"]),a(h,{title:e.$t("pages.menu.apiName"),"data-index":"name"},null,8,["title"])]),_:1},8,["data"])]),_:1},8,["visible"])]),_:1},8,["visible","title","size"])}}},Ye=te(Ue,[["__scopeId","data-v-9668f497"]]);export{Ye as default};
