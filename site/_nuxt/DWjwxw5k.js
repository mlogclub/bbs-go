import{_ as N}from"./5InM8hYO.js";import{_ as R}from"./BN_28Xcu.js";import{_ as F}from"./XKCCBwzU.js";import{m as U,C as q,g as E,K as J,o,h,w as p,e as s,b as e,t as r,P as se,z as I,A as P,H as L,_ as T,u as G,n as z,c as y,d as _,s as $,f as S,F as W,r as V,M as ne,D as v,B as D,q as K,i as X}from"./Ck7AnVGd.js";import{M as Y}from"./DhWUe_9n.js";import{_ as B}from"./BWHUeAHN.js";import{C as A}from"./0crEKJaj.js";import{_ as Q}from"./1poyL4QY.js";import{u as H,a as oe}from"./BCWAYn_K.js";import{u as re}from"./Dj8WmZfa.js";import{C as le}from"./DJTGgUfV.js";const ae=U("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const ie=U("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);const ce=U("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const ue=U("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);const de=U("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),_e={class:"ml-1"},Z={__name:"FollowBtn",props:{userId:{type:String,required:!0}},emits:["onFollowed"],async setup(l,{emit:c}){let t,n;const u=q(),a=l,m=c,{data:d}=([t,n]=E(()=>J(`/api/fans/is_followed?userId=${a.userId}`)),t=await t,n(),t);async function g(){if(!u.isLogin){se();return}try{d.value?(await I("/api/fans/unfollow",P({userId:a.userId})),d.value=!1,m("onFollowed",a.userId,!1)):(await I("/api/fans/follow",P({userId:a.userId})),d.value=!0,m("onFollowed",a.userId,!0))}catch(i){L(i.message||i)}}return(i,b)=>{const f=N;return o(),h(f,{variant:s(d)?"outline":"default",size:"sm",class:"h-7 text-xs",onClick:g},{default:p(()=>[s(d)?(o(),h(s(ue),{key:1,class:"size-3"})):(o(),h(s(de),{key:0,class:"size-3"})),e("span",_e,r(s(d)?i.$t("component.followBtn.followed"):i.$t("component.followBtn.follow")),1)]),_:1},8,["variant"])}}},me=""+new URL("default-user-bg.gRJjvmRh.jpg",import.meta.url).href,pe={class:"profile-info"},fe={class:"metas"},ye={class:"nickname-row"},ge={class:"nickname"},he={key:0,class:"level-badge"},be={class:"level-label"},ve={class:"level-number"},ke=["src","alt"],we={key:0,class:"description"},$e={class:"action-btns"},Ce={__name:"UserProfile",props:{user:{type:Object,required:!0},badges:{type:Array,default:()=>[]}},setup(l){const{t:c}=G(),t=l,n=z(t.user),u=q(),a=v(()=>`/user/${n.value.id}/badges`),m=v(()=>(t.badges||[]).filter(w=>w.worn).slice(0,3)),d=v(()=>u.user),g=v(()=>n.value&&d.value&&n.value.id===d.value.id),i=v(()=>n.value&&n.value.level!==void 0&&n.value.level!==null),b=v(()=>!n.value||n.value.level===void 0?0:n.value.level),f=v(()=>n.value.smallBackgroundImage?n.value.smallBackgroundImage:me);async function k(C){const w=C.target.files;if(!(w.length<=0))try{const x=w[0],O=new FormData;O.append("image",x,x.name);const j=await I("/api/upload",O);await I("/api/user/set_background_image",P({backgroundImage:j.url})),n.value=await u.fetchCurrent(),D(c("component.userProfile.backgroundSuccess"))}catch(x){L(x.message||x),console.error(x)}}return(C,w)=>{const x=N,O=R,j=F,te=Z;return o(),y("div",{class:"profile",style:ne({backgroundImage:"url("+s(f)+")"})},[s(g)?(o(),h(x,{key:0,class:"change-bg"},{default:p(()=>[e("label",null,[e("input",{type:"file",onChange:k},null,32),_(s(ie),{size:"16"}),e("span",null,r(C.$t("component.userProfile.setBackground")),1)])]),_:1})):$("",!0),_(O,{user:s(n),round:!0,size:100,class:"profile-avatar"},null,8,["user"]),e("div",pe,[e("div",fe,[e("div",ye,[e("span",ge,[_(j,{to:"/user/"+s(n).id},{default:p(()=>[S(r(s(n).nickname),1)]),_:1},8,["to"])]),s(i)?(o(),y("span",he,[e("span",be,r(C.$t("component.userProfile.level")),1),e("span",ve,r(s(b)),1)])):$("",!0),s(m).length?(o(!0),y(W,{key:1},V(s(m),M=>(o(),h(j,{key:M.id,to:s(a),class:"badge-icon shrink-0",title:M.title},{default:p(()=>[M.icon?(o(),y("img",{key:0,src:M.icon,alt:M.title,class:"h-6 w-6 object-contain"},null,8,ke)):(o(),h(s(Y),{key:1,class:"h-5 w-5"}))]),_:2},1032,["to","title"]))),128)):$("",!0)]),s(n).description?(o(),y("div",we,[e("p",null,r(s(n).description),1)])):$("",!0)]),e("div",$e,[!s(d)||s(d).id!==s(n).id?(o(),h(te,{key:0,"user-id":s(n).id},null,8,["user-id"])):$("",!0)])])],4)}}},bt=T(Ce,[["__scopeId","data-v-a904c77c"]]),xe={class:"extra-info"},Fe={__name:"MyCounts",props:{user:{type:Object,required:!0}},setup(l){return(c,t)=>{const n=F,u=B;return o(),h(u,{title:c.$t("component.myCounts.title")},{default:p(()=>[e("ul",xe,[e("li",null,[e("span",null,r(c.$t("component.myCounts.level")),1),t[0]||(t[0]=e("br",null,null,-1)),e("b",null,r(`Lv.${l.user.level??0}`),1)]),e("li",null,[e("span",null,r(c.$t("component.myCounts.score")),1),t[1]||(t[1]=e("br",null,null,-1)),_(n,{to:"/user/scores"},{default:p(()=>[e("b",null,r(l.user.score),1)]),_:1})]),e("li",null,[e("span",null,r(c.$t("component.myCounts.topicCount")),1),t[2]||(t[2]=e("br",null,null,-1)),e("b",null,r(l.user.topicCount),1)]),e("li",null,[e("span",null,r(c.$t("component.myCounts.commentCount")),1),t[3]||(t[3]=e("br",null,null,-1)),e("b",null,r(l.user.commentCount),1)])])]),_:1},8,["title"])}}},Ie=T(Fe,[["__scopeId","data-v-56f8e701"]]),Se={key:0,class:"text-sm text-slate-500 dark:text-slate-400"},Be={key:1,class:"space-y-3"},Me={class:"flex flex-wrap gap-2"},Pe=["src","alt"],Ue=6,Oe={__name:"UserBadgesWidget",props:{user:{type:Object,required:!0}},async setup(l){let c,t;const n=l,u=v(()=>`/api/badge/badges?userId=${n.user?.id??0}`),{data:a}=([c,t]=E(()=>J(u,{initialCache:!1})),c=await c,t(),c),m=v(()=>`/user/${n.user.id}/badges`),d=v(()=>a.value??[]),g=v(()=>d.value.filter(b=>b.owned!==!1)),i=v(()=>g.value.slice(0,Ue));return(b,f)=>{const k=F,C=B;return o(),h(C,null,{title:p(()=>[e("span",null,r(b.$t("component.userBadges.title")),1),f[0]||(f[0]=e("span",null," ",-1)),e("span",null,r(s(g).length),1)]),actions:p(()=>[_(k,{to:s(m),class:"inline-flex items-center gap-1"},{default:p(()=>[S(r(b.$t("component.userBadges.viewAll"))+" ",1),_(s(A),{class:"h-4 w-4"})]),_:1},8,["to"])]),default:p(()=>[s(g).length===0?(o(),y("div",Se,r(b.$t("component.userBadges.noBadges")),1)):(o(),y("div",Be,[e("div",Me,[(o(!0),y(W,null,V(s(i),w=>(o(),h(k,{key:w.id,to:s(m),class:"flex h-10 w-10 shrink-0 items-center justify-center overflow-hidden rounded-lg border border-amber-200/80 bg-amber-50/50 dark:border-amber-800/60 dark:bg-amber-900/20",title:w.title},{default:p(()=>[w.icon?(o(),y("img",{key:0,src:w.icon,alt:w.title,class:"h-8 w-8 object-contain"},null,8,Pe)):(o(),h(s(Y),{key:1,class:"h-6 w-6"}))]),_:2},1032,["to","title"]))),128))])]))]),_:1})}}},je={class:"stable"},Le={class:"str"},qe={class:"slabel"},ze={class:"svalue"},We={class:"str"},Ae={class:"slabel"},De={class:"svalue"},Te={key:0,class:"str"},Ve={class:"slabel"},He={class:"svalue"},Ne=["href"],Re={__name:"MyProfile",props:{user:{type:Object,required:!0}},setup(l){const c=l,t=q(),n=v(()=>t.isLogin&&t.user&&t.user.id===c.user.id);return(u,a)=>{const m=F,d=B;return o(),h(d,{title:u.$t("component.myProfile.title")},{actions:p(()=>[s(n)?(o(),h(m,{key:0,to:"/user/profile",class:"inline-flex items-center gap-1"},{default:p(()=>[S(r(u.$t("component.myProfile.editProfile"))+" ",1),_(s(A),{class:"h-4 w-4"})]),_:1})):$("",!0)]),default:p(()=>[e("div",je,[e("div",Le,[e("div",qe,r(u.$t("component.myProfile.nickname")),1),e("div",ze,r(l.user.nickname),1)]),e("div",We,[e("div",Ae,r(u.$t("component.myProfile.description")),1),e("div",De,r(l.user.description),1)]),l.user.homePage?(o(),y("div",Te,[e("div",Ve,r(u.$t("component.myProfile.homePage")),1),e("div",He,[e("a",{href:l.user.homePage,target:"_blank",rel:"nofollow"},r(l.user.homePage),9,Ne)])])):$("",!0)])]),_:1},8,["title"])}}},Ee={props:{users:{type:Array,default(){return[]}}},methods:{onFollowed(l,c){this.$emit("onFollowed",l,c)}}},Je={key:0},Ge={class:"user-follow-item-info"},Ke={class:"nickname"},Xe={class:"description"};function Ye(l,c,t,n,u,a){const m=R,d=F,g=Z;return o(),y("div",null,[t.users&&t.users.length?(o(),y("div",Je,[(o(!0),y(W,null,V(t.users,i=>(o(),y("div",{key:i.id,class:"user-follow-item"},[_(m,{user:i,size:40},null,8,["user"]),e("div",Ge,[e("div",Ke,[_(d,{to:"/user/"+i.id},{default:p(()=>[S(r(i.nickname),1)]),_:2},1032,["to"])]),e("div",Xe,r(i.description)+r(i.description)+r(i.description),1)]),e("div",null,[_(g,{"user-id":i.id,followed:i.followed,onOnFollowed:a.onFollowed},null,8,["user-id","followed","onOnFollowed"])])]))),128))])):$("",!0)])}const ee=Object.assign(T(Ee,[["render",Ye],["__scopeId","data-v-2dfa0904"]]),{__name:"UserFollowList"}),Qe={key:0},Ze={__name:"FansWidget",props:{user:{type:Object,required:!0}},setup(l){const c=l,t=z([]);K(()=>{n()});async function n(){const a=await X(`/api/fans/recent/fans?userId=${c.user.id}`);t.value=a.results}async function u(a,m){await n()}return(a,m)=>{const d=F,g=ee,i=Q,b=B;return o(),h(b,null,{title:p(()=>[e("span",null,r(a.$t("component.fansWidget.title")),1),m[0]||(m[0]=e("span",null," ",-1)),e("span",null,r(l.user.fansCount),1)]),actions:p(()=>[_(d,{to:`/user/${l.user.id}/fans`,class:"inline-flex items-center gap-1"},{default:p(()=>[S(r(a.$t("component.fansWidget.more"))+" ",1),_(s(A),{class:"h-4 w-4"})]),_:1},8,["to"])]),default:p(()=>[s(t)&&s(t).length?(o(),y("div",Qe,[_(g,{users:s(t),onOnFollowed:u},null,8,["users"])])):(o(),h(i,{key:1,"show-logo":!1}))]),_:1})}}},et={key:0},tt={__name:"FollowWidget",props:{user:{type:Object,required:!0}},setup(l){const c=l,t=z([]);K(()=>{n()});async function n(){const a=await X(`/api/fans/recent/follow?userId=${c.user.id}`);t.value=a.results}async function u(a,m){await n()}return(a,m)=>{const d=F,g=ee,i=Q,b=B;return o(),h(b,null,{title:p(()=>[e("span",null,r(a.$t("component.followWidget.title")),1),m[0]||(m[0]=e("span",null," ",-1)),e("span",null,r(l.user.followCount),1)]),actions:p(()=>[_(d,{to:`/user/${l.user.id}/followed`,class:"inline-flex items-center gap-1"},{default:p(()=>[S(r(a.$t("component.followWidget.more"))+" ",1),_(s(A),{class:"h-4 w-4"})]),_:1},8,["to"])]),default:p(()=>[s(t)&&s(t).length?(o(),y("div",et,[_(g,{users:s(t),onOnFollowed:u},null,8,["users"])])):(o(),h(i,{key:1,"show-logo":!1}))]),_:1})}}},st={class:"list-none space-y-2 text-sm [&_li]:hover:cursor-pointer [&_li]:hover:bg-amber-50 [&_li]:hover:text-amber-800"},nt={key:0,class:"flex items-center gap-2"},ot={class:"flex items-center gap-2"},rt={key:0,class:"flex items-center gap-2"},lt={__name:"UserCenterOperations",props:{user:{type:Object,required:!0}},emits:["forbidden-changed"],setup(l,{emit:c}){const{t}=G(),n=q(),u=l,a=c,m=v(()=>H(n.user)),d=v(()=>H(n.user)||oe(n.user)),g=f=>{const k=f>0?t("component.userCenterSidebar.confirmForbidden"):t("component.userCenterSidebar.confirmForbiddenForever");re(k,{title:t("component.userCenterSidebar.dialogTitle"),confirmText:t("component.userCenterSidebar.confirmButtonText"),cancelText:t("component.userCenterSidebar.cancelButtonText")}).then(()=>{i(f)}).catch(()=>{})},i=async f=>{try{await I("/api/user/forbidden",P({userId:u.user.id,days:f})),a("forbidden-changed",!0),D(t("component.userCenterSidebar.forbiddenSuccess"))}catch(k){console.log(k),L(t("component.userCenterSidebar.forbiddenFailed"))}},b=async()=>{try{await I("/api/user/forbidden",P({userId:u.user.id,days:0})),a("forbidden-changed",!1),D(t("component.userCenterSidebar.removeForbiddenSuccess"))}catch(f){console.log(f),L(t("component.userCenterSidebar.removeForbiddenFailed"))}};return(f,k)=>{const C=B;return s(d)?(o(),h(C,{key:0,title:f.$t("component.userCenterSidebar.operations")},{default:p(()=>[e("ul",st,[l.user.forbidden?(o(),y("li",nt,[_(s(le),{class:"shrink-0",size:14}),e("a",{class:"text-primary",onClick:b},r(f.$t("component.userCenterSidebar.removeForbidden")),1)])):(o(),y(W,{key:1},[e("li",ot,[_(s(ae),{class:"shrink-0",size:14}),e("a",{class:"text-primary",onClick:k[0]||(k[0]=w=>g(7))},r(f.$t("component.userCenterSidebar.forbidden7Days")),1)]),s(m)?(o(),y("li",rt,[_(s(ce),{class:"shrink-0",size:14}),e("a",{class:"text-primary",onClick:k[1]||(k[1]=w=>g(-1))},r(f.$t("component.userCenterSidebar.forbiddenForever")),1)])):$("",!0)],64))])]),_:1},8,["title"])):$("",!0)}}},at={class:"left-container space-y-4"},vt={__name:"UserCenterSidebar",props:{user:{type:Object,required:!0}},setup(l){const t=z(l.user);return(n,u)=>{const a=Ie,m=Oe,d=Re,g=Ze,i=tt,b=lt;return o(),y("div",at,[_(a,{user:s(t)},null,8,["user"]),_(m,{user:s(t)},null,8,["user"]),_(d,{user:s(t)},null,8,["user"]),_(g,{user:s(t)},null,8,["user"]),_(i,{user:s(t)},null,8,["user"]),_(b,{user:s(t),onForbiddenChanged:u[0]||(u[0]=f=>s(t).forbidden=f)},null,8,["user"])])}}};export{de as U,bt as _,vt as a,ee as b};
