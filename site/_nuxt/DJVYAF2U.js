import{_ as de}from"./UwGaH15d.js";import{_ as F,a as I,b as K,c as M}from"./BHeC9MU0.js";import{_ as R}from"./Bj_4IzLa.js";import{a as pe,_ as me}from"./BT-mllKq.js";import{_ as J}from"./nHyB59Vm.js";import{_ as z}from"./HzVF1qNI.js";import{u as L,o as _,h as E,w as a,d as e,f as D,t as l,b as s,J as S,e as t,i as W,n as v,z as V,A as q,B as x,H as A,Z as N,c as h,s as C,L as _e,_ as fe,a as ge,g as j,k as we,K as O,D as ve}from"./IMHBmAvM.js";import{_ as he}from"./DYGa34Qb.js";import{u as $e}from"./DJY5Y4zn.js";import{u as De}from"./C31CG-Qp.js";import{A as ye}from"./BNCisbwu.js";import{S as Ue}from"./CP24wcLs.js";import"./CWBW37gM.js";import"./DVjKhMGR.js";import"./DWG3xSCv.js";import"./CboA2NrW.js";import"./DmwfaKwn.js";import"./BFULNkRl.js";import"./B1wiTl2V.js";import"./Dy4Z_VQo.js";import"./CcFcSr0Z.js";import"./FUKBWQwh.js";import"./DDHZDh0S.js";import"./-N5s2Nzn.js";import"./4YIWWuwH.js";import"./BZY-t1L7.js";import"./Dv21RA73.js";import"./iGIsgRmF.js";const be={class:"space-y-4 py-4"},ke={class:"space-y-2"},Pe={__name:"AccountSetUsernameDialog",emits:["success"],setup(H,{expose:r,emit:d}){const{t:p}=L(),n=v(!1),f=d,i=v(null),w=async()=>{n.value=!0;const o=await W("/api/user/current");i.value=o.username},g=async()=>{try{await V("/api/user/set_username",q({username:i.value})),n.value=!1,f("success"),x(p("component.setUsernameDialog.success"))}catch(o){A(o.message||o)}};return r({show:w}),(o,c)=>{const y=K,b=I,$=me,U=pe,P=J,k=z,B=R,m=F,G=M;return _(),E(G,{open:t(n),"onUpdate:open":c[2]||(c[2]=T=>S(n)?n.value=T:null)},{default:a(()=>[e(m,{class:"sm:max-w-md"},{default:a(()=>[e(b,null,{default:a(()=>[e(y,null,{default:a(()=>[D(l(o.$t("component.setUsernameDialog.title")),1)]),_:1})]),_:1}),s("div",be,[e(U,{class:"border-blue-200 bg-blue-50"},{default:a(()=>[e($,{class:"text-sm text-blue-700"},{default:a(()=>[D(l(o.$t("component.setUsernameDialog.usernameRule")),1)]),_:1})]),_:1}),s("div",ke,[e(P,{id:"username",modelValue:t(i),"onUpdate:modelValue":c[0]||(c[0]=T=>S(i)?i.value=T:null),type:"text",placeholder:o.$t("component.setUsernameDialog.usernamePlaceholder")},null,8,["modelValue","placeholder"])])]),e(B,null,{default:a(()=>[e(k,{variant:"outline",onClick:c[1]||(c[1]=T=>n.value=!1)},{default:a(()=>[D(l(o.$t("dialog.cancel")),1)]),_:1}),e(k,{onClick:g},{default:a(()=>[D(l(o.$t("dialog.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}},Be={class:"space-y-4 py-8"},Ce={__name:"AccountSetEmailDialog",emits:["success"],setup(H,{expose:r,emit:d}){const{t:p}=L(),n=v(!1),f=d,i=v(null),w=async()=>{n.value=!0;const o=await W("/api/user/current");i.value=o.email},g=async()=>{try{await V("/api/user/set_email",q({email:i.value})),n.value=!1,f("success"),x(p("component.setEmailDialog.success"))}catch(o){A(o.message||o)}};return r({show:w}),(o,c)=>{const y=K,b=I,$=J,U=z,P=R,k=F,B=M;return _(),E(B,{open:t(n),"onUpdate:open":c[2]||(c[2]=m=>S(n)?n.value=m:null)},{default:a(()=>[e(k,null,{default:a(()=>[e(b,null,{default:a(()=>[e(y,null,{default:a(()=>[D(l(o.$t("component.setEmailDialog.title")),1)]),_:1})]),_:1}),s("div",Be,[e($,{id:"email",modelValue:t(i),"onUpdate:modelValue":c[0]||(c[0]=m=>S(i)?i.value=m:null),type:"email",placeholder:o.$t("component.setEmailDialog.emailPlaceholder")},null,8,["modelValue","placeholder"])]),e(P,null,{default:a(()=>[e(U,{variant:"outline",onClick:c[1]||(c[1]=m=>n.value=!1)},{default:a(()=>[D(l(o.$t("dialog.cancel")),1)]),_:1}),e(U,{onClick:g},{default:a(()=>[D(l(o.$t("dialog.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}},Se={class:"space-y-6 py-4"},Ve={__name:"AccountSetPasswordDialog",emits:["success"],setup(H,{expose:r,emit:d}){const{t:p}=L(),n=v(!1),f=d,i=v({password:"",rePassword:""}),w=async()=>{n.value=!0;const o=await W("/api/user/current");email.value=o.email},g=async()=>{try{await V("/api/user/set_password",q(i.value)),n.value=!1,f("success"),x(p("component.setPasswordDialog.success"))}catch(o){A(o.message||o)}};return r({show:w}),(o,c)=>{const y=K,b=I,$=J,U=z,P=R,k=F,B=M;return _(),E(B,{open:t(n),"onUpdate:open":c[3]||(c[3]=m=>S(n)?n.value=m:null)},{default:a(()=>[e(k,{class:"sm:max-w-md"},{default:a(()=>[e(b,null,{default:a(()=>[e(y,null,{default:a(()=>[D(l(o.$t("component.setPasswordDialog.title")),1)]),_:1})]),_:1}),s("div",Se,[s("div",null,[e($,{id:"password",modelValue:t(i).password,"onUpdate:modelValue":c[0]||(c[0]=m=>t(i).password=m),type:"password",placeholder:o.$t("component.setPasswordDialog.passwordPlaceholder"),onKeydown:N(g,["enter"])},null,8,["modelValue","placeholder"])]),s("div",null,[e($,{id:"rePassword",modelValue:t(i).rePassword,"onUpdate:modelValue":c[1]||(c[1]=m=>t(i).rePassword=m),type:"password",placeholder:o.$t("component.setPasswordDialog.rePasswordPlaceholder"),onKeydown:N(g,["enter"])},null,8,["modelValue","placeholder"])])]),e(P,null,{default:a(()=>[e(U,{variant:"outline",onClick:c[2]||(c[2]=m=>n.value=!1)},{default:a(()=>[D(l(o.$t("dialog.cancel")),1)]),_:1}),e(U,{onClick:g},{default:a(()=>[D(l(o.$t("dialog.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}},xe={class:"space-y-4 py-4"},Ae={class:"space-y-2"},Ee={class:"space-y-2"},He={class:"space-y-2"},Te={__name:"AccountUpdatePasswordDialog",emits:["success"],setup(H,{expose:r,emit:d}){const{t:p}=L(),n=v(!1),f=d,i=v({oldPassword:"",password:"",rePassword:""}),w=async()=>{n.value=!0},g=async()=>{try{await V("/api/user/update_password",q(i.value)),n.value=!1,f("success"),x(p("component.updatePasswordDialog.success"))}catch(o){A(o.message||o)}};return r({show:w}),(o,c)=>{const y=K,b=I,$=J,U=z,P=R,k=F,B=M;return _(),E(B,{open:t(n),"onUpdate:open":c[4]||(c[4]=m=>S(n)?n.value=m:null)},{default:a(()=>[e(k,null,{default:a(()=>[e(b,null,{default:a(()=>[e(y,null,{default:a(()=>[D(l(o.$t("component.updatePasswordDialog.title")),1)]),_:1})]),_:1}),s("div",xe,[s("div",Ae,[e($,{id:"oldPassword",modelValue:t(i).oldPassword,"onUpdate:modelValue":c[0]||(c[0]=m=>t(i).oldPassword=m),type:"password",placeholder:o.$t("component.updatePasswordDialog.oldPasswordPlaceholder"),onKeydown:N(g,["enter"])},null,8,["modelValue","placeholder"])]),s("div",Ee,[e($,{id:"newPassword",modelValue:t(i).password,"onUpdate:modelValue":c[1]||(c[1]=m=>t(i).password=m),type:"password",placeholder:o.$t("component.updatePasswordDialog.newPasswordPlaceholder"),onKeydown:N(g,["enter"])},null,8,["modelValue","placeholder"])]),s("div",He,[e($,{id:"rePassword",modelValue:t(i).rePassword,"onUpdate:modelValue":c[2]||(c[2]=m=>t(i).rePassword=m),type:"password",placeholder:o.$t("component.updatePasswordDialog.rePasswordPlaceholder"),onKeydown:N(g,["enter"])},null,8,["modelValue","placeholder"])])]),e(P,null,{default:a(()=>[e(U,{variant:"outline",onClick:c[3]||(c[3]=m=>n.value=!1)},{default:a(()=>[D(l(o.$t("dialog.cancel")),1)]),_:1}),e(U,{onClick:g},{default:a(()=>[D(l(o.$t("dialog.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}},Fe={class:"px-2 pb-4"},Ie={class:"text-center text-sm text-muted-foreground mb-5 mt-4"},Ke={__name:"AccountWxBindDialog",setup(H,{expose:r}){const d=v(!1),p=async()=>{const f=await W("/api/login/wx_login_config",{params:{bind:!0}});new window.WxLogin({self_redirect:!1,id:"wx_bind_container",appid:f.appid,scope:f.scope,redirect_uri:f.redirect_uri,state:f.state||"",stylelite:1})};return r({show:()=>{d.value=!0,setTimeout(()=>{p()},300)}}),(f,i)=>{const w=K,g=I,o=F,c=M;return _(),E(c,{open:t(d),"onUpdate:open":i[0]||(i[0]=y=>S(d)?d.value=y:null)},{default:a(()=>[e(o,{class:"w-[340px] max-w-[340px]"},{default:a(()=>[e(g,null,{default:a(()=>[e(w,null,{default:a(()=>[D(l(f.$t("component.wxBindDialog.title")),1)]),_:1})]),_:1}),s("div",Fe,[s("div",Ie,l(f.$t("component.wxBindDialog.scanTip")),1),i[1]||(i[1]=s("div",{id:"wx_bind_container",class:"wx_bind_container"},null,-1))])]),_:1})]),_:1},8,["open"])}}},Me={class:"px-2 pb-4"},Ne={class:"text-center text-sm text-muted-foreground mb-5 mt-4"},ze={key:0,class:"mr-2 h-5 w-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Le={key:1},We={key:2},Ge={__name:"AccountGoogleBindDialog",setup(H,{expose:r}){const d=v(!1),p=v(!1),n=async()=>{p.value=!0;try{const i=await W("/api/login/google_login_config",{params:{bind:!0}});window.location.href=i.authUrl}catch(i){_e(i),p.value=!1}};return r({show:()=>{d.value=!0}}),(i,w)=>{const g=K,o=I,c=z,y=F,b=M;return _(),E(b,{open:t(d),"onUpdate:open":w[0]||(w[0]=$=>S(d)?d.value=$:null)},{default:a(()=>[e(y,{class:"w-[400px] max-w-[400px]"},{default:a(()=>[e(o,null,{default:a(()=>[e(g,null,{default:a(()=>[D(l(i.$t("component.googleBindDialog.title")),1)]),_:1})]),_:1}),s("div",Me,[s("div",Ne,l(i.$t("component.googleBindDialog.bindTip")),1),e(c,{class:"w-full",variant:"outline",disabled:t(p),onClick:n},{default:a(()=>[t(p)?C("",!0):(_(),h("svg",ze,[...w[1]||(w[1]=[s("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"},null,-1),s("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"},null,-1),s("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"},null,-1),s("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"},null,-1)])])),t(p)?(_(),h("span",Le,l(i.$t("component.googleBindDialog.binding")),1)):(_(),h("span",We,l(i.$t("component.googleBindDialog.bindButton")),1))]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])}}},Re={class:"space-x-1"},Je={class:"settings m-4"},qe={class:"settings-item"},Ze={class:"settings-item-title"},je={class:"settings-item-input"},Oe={class:"input-value"},Qe={class:"action-box"},Xe={class:"settings-item"},Ye={class:"settings-item-title"},eo={class:"settings-item-input"},oo={class:"input-value"},so={key:0,style:{"margin-left":"4px","font-size":"80%"}},to={class:"action-box"},no={class:"settings-item"},ao={class:"settings-item-title"},lo={class:"settings-item-input"},io={class:"input-value"},co={class:"action-box"},uo={key:0,class:"settings-item"},ro={class:"settings-item-title"},po={class:"settings-item-input"},mo={class:"input-value"},_o={class:"action-box"},fo={key:1,class:"settings-item"},go={class:"settings-item-title"},wo={class:"settings-item-input"},vo={class:"input-value"},ho={class:"action-box"},$o={__name:"account",async setup(H){let r,d;const{t:p}=L();ge({title:$e(p("user.profile.account.title"))});const{data:n,refresh:f}=([r,d]=j(()=>O("/api/user/current")),r=await r,d(),r),i=we(),w=ve(()=>i.config.loginConfig||{}),{data:g,refresh:o}=([r,d]=j(()=>O("/api/user/wx_bind_info")),r=await r,d(),r),{data:c,refresh:y}=([r,d]=j(()=>O("/api/user/google_bind_info")),r=await r,d(),r),b=v(null),$=v(null),U=v(null),P=v(null),k=v(null),B=v(null),m=()=>b.value.show(),G=()=>$.value.show(),T=()=>U.value.show(),Q=()=>P.value.show(),X=()=>k.value.show(),Y=()=>B.value.show();async function ee(){const u=De();try{await V("/api/user/send_verify_email"),x(p("user.profile.account.emailVerifySuccess",{email:n.value.email}))}catch(Z){A(Z.message||Z)}finally{u.close()}}const oe=()=>{confirm(p("user.profile.account.confirmUnbind"))&&V("/api/login/wx_unbind").then(()=>{o(),x(p("user.profile.account.unbindSuccess"))}).catch(u=>{A(p("user.profile.account.unbindFailed")+"："+(u.message||u))})},se=()=>{confirm(p("user.profile.account.confirmUnbind"))&&V("/api/login/google_unbind").then(()=>{y(),x(p("user.profile.account.unbindSuccess"))}).catch(u=>{A(p("user.profile.account.unbindFailed")+"："+(u.message||u))})};return(u,Z)=>{const te=de,ne=Pe,ae=Ce,le=Ve,ie=Te,ce=Ke,ue=Ge,re=he;return t(n)?(_(),E(re,{key:0},{title:a(()=>[s("div",Re,[e(t(Ue),{class:"inline-block h-4 w-4"}),s("span",null,l(u.$t("user.profile.account.title")),1)])]),actions:a(()=>[e(te,{to:"/user/"+t(n).id,class:"space-x-2"},{default:a(()=>[e(t(ye),{class:"inline-block h-4 w-4"}),s("span",null,l(u.$t("user.profile.backToProfile")),1)]),_:1},8,["to"])]),default:a(()=>[s("div",Je,[s("div",qe,[s("div",Ze,l(u.$t("user.profile.account.username")),1),s("div",je,[s("div",Oe,l(t(n).username),1),s("div",Qe,[t(n).username?C("",!0):(_(),h("a",{key:0,onClick:m},l(u.$t("user.profile.account.set")),1))])])]),s("div",Xe,[s("div",Ye,l(u.$t("user.profile.account.email")),1),s("div",eo,[s("div",oo,[s("span",null,l(t(n).email),1),t(n).emailVerified?(_(),h("span",so,"("+l(u.$t("user.profile.account.verified"))+")",1)):C("",!0)]),s("div",to,[t(n).email?(_(),h("a",{key:0,onClick:G},l(u.$t("user.profile.account.modify")),1)):C("",!0),t(n).email&&!t(n).emailVerified?(_(),h("a",{key:1,onClick:ee},l(u.$t("user.profile.account.verify")),1)):C("",!0),t(n).email?C("",!0):(_(),h("a",{key:2,onClick:G},l(u.$t("user.profile.account.set")),1))])])]),s("div",no,[s("div",ao,l(u.$t("user.profile.account.password")),1),s("div",lo,[s("div",io,l(t(n).passwordSet?u.$t("user.profile.account.passwordSet"):u.$t("user.profile.account.passwordNotSet")),1),s("div",co,[t(n).passwordSet?(_(),h("a",{key:0,onClick:Q},l(u.$t("user.profile.account.modify")),1)):(_(),h("a",{key:1,onClick:T},l(u.$t("user.profile.account.set")),1))])])]),t(w).weixinLogin?.enabled?(_(),h("div",uo,[s("div",ro,l(u.$t("user.profile.account.wechat")),1),s("div",po,[s("div",mo,l(t(g)?.bind?`${t(g).nickname}`:u.$t("user.profile.account.wechatNotBound")),1),s("div",_o,[t(g)?.bind?(_(),h("a",{key:0,onClick:oe},l(u.$t("user.profile.account.unbind")),1)):(_(),h("a",{key:1,onClick:X},l(u.$t("user.profile.account.bind")),1))])])])):C("",!0),t(w).googleLogin?.enabled?(_(),h("div",fo,[s("div",go,l(u.$t("user.profile.account.google")),1),s("div",wo,[s("div",vo,l(t(c)?.bind?`${t(c).nickname}`:u.$t("user.profile.account.googleNotBound")),1),s("div",ho,[t(c)?.bind?(_(),h("a",{key:0,onClick:se},l(u.$t("user.profile.account.unbind")),1)):(_(),h("a",{key:1,onClick:Y},l(u.$t("user.profile.account.bind")),1))])])])):C("",!0)]),e(ne,{ref_key:"setUsernameDialog",ref:b,onSuccess:t(f)},null,8,["onSuccess"]),e(ae,{ref_key:"setEmailDialog",ref:$,onSuccess:t(f)},null,8,["onSuccess"]),e(le,{ref_key:"setPasswordDialog",ref:U,onSuccess:t(f)},null,8,["onSuccess"]),e(ie,{ref_key:"updatePasswordDialog",ref:P,onSuccess:t(f)},null,8,["onSuccess"]),e(ce,{ref_key:"wxBindDialog",ref:k},null,512),e(ue,{ref_key:"googleBindDialog",ref:B},null,512)]),_:1})):C("",!0)}}},jo=fe($o,[["__scopeId","data-v-2aec7d26"]]);export{jo as default};
