import{_ as B,a as H}from"./BT-mllKq.js";import{d as O,_ as V,a as L,c as N,b as j}from"./Aq7IsWaT.js";import{u as U,C as z,o as u,h as g,w as i,e,d as r,b as o,t as c,f as _,s as y,T as q,D as A,E as T,z as x,G,H as S,A as J,B as K,_ as R,j as Q,g as W,l as X,a as Y,c as C,P as Z,I as ee,F as te,r as ne,K as oe}from"./IMHBmAvM.js";import{u as se,a as ie}from"./BCWAYn_K.js";import{u as ae}from"./BCbtPZa4.js";import{E as re,a as ce,b as le}from"./EyxChluj.js";import{_ as me}from"./UwGaH15d.js";import{u as ue}from"./DJY5Y4zn.js";import"./iGIsgRmF.js";import"./CWBW37gM.js";import"./DWG3xSCv.js";import"./DDHZDh0S.js";import"./CboA2NrW.js";import"./DmwfaKwn.js";import"./BFULNkRl.js";import"./B1wiTl2V.js";import"./Dy4Z_VQo.js";import"./CcFcSr0Z.js";import"./FUKBWQwh.js";import"./BZY-t1L7.js";import"./C6Y-ieo6.js";import"./Cxw1WQmr.js";import"./D-pAyiJO.js";import"./GHR_VWTl.js";import"./Cop6u61-.js";import"./mWIteSzr.js";import"./Dd-PvC5E.js";import"./DVjKhMGR.js";import"./-N5s2Nzn.js";import"./HzVF1qNI.js";import"./Dv21RA73.js";import"./9rp5OSjE.js";import"./hbwzUS4v.js";import"./Iih9WEmM.js";import"./DmPMBcKm.js";import"./oPgK-6DP.js";import"./BptVNsbJ.js";import"./WZu4RPZE.js";import"./BOEcqi2e.js";import"./eDnzarN5.js";import"./Dj53LeHM.js";const de=["aria-label","title"],_e={class:"sr-only"},pe={__name:"ArticleManageMenu",props:{article:{type:Object,required:!0}},setup(F){const l=F,{t:a}=U(),d=z(),p=se(d.user),t=ie(d.user),M=A(()=>d.user&&d.user.id===l.article.user.id),v=A(()=>M.value||p||t);async function m(n){n==="edit"?w():n==="delete"?$():n==="forbidden7Days"?await b(7):n==="forbiddenForever"?await b(-1):console.log("click on item "+n)}async function b(n){try{await x("/api/user/forbidden",J({userId:l.article.user.id,days:n})),K(a("component.articleManageMenu.forbiddenSuccess"))}catch(s){S(a("component.articleManageMenu.forbiddenFailed")),console.error(s)}}function $(){ae(a("component.articleManageMenu.confirmDelete")).then(function(){x(`/api/article/delete/${l.article.id}`).then(()=>{G({message:a("component.articleManageMenu.deleteSuccess"),onClose(){T("/articles")}})}).catch(n=>{S(a("component.articleManageMenu.deleteFailed")+(n.message||n))})})}function w(){T(`/article/edit/${l.article.id}`)}return(n,s)=>{const D=V,f=N,h=j,I=L,P=O,E=q;return u(),g(E,null,{default:i(()=>[e(v)?(u(),g(P,{key:0},{default:i(()=>[r(D,{"as-child":""},{default:i(()=>[o("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md text-muted-foreground transition-colors hover:bg-accent hover:text-accent-foreground","aria-label":e(a)("common.moreActions"),title:e(a)("common.moreActions")},[r(e(re),{class:"h-4 w-4"}),o("span",_e,c(e(a)("common.moreActions")),1)],8,de)]),_:1}),r(I,{align:"end",class:"min-w-[160px]"},{default:i(()=>[r(f,{onClick:s[0]||(s[0]=k=>m("edit"))},{default:i(()=>[_(c(n.$t("component.articleManageMenu.edit")),1)]),_:1}),r(f,{onClick:s[1]||(s[1]=k=>m("delete"))},{default:i(()=>[_(c(n.$t("component.articleManageMenu.delete")),1)]),_:1}),e(p)||e(t)?(u(),g(h,{key:0})):y("",!0),e(p)||e(t)?(u(),g(f,{key:1,onClick:s[2]||(s[2]=k=>m("forbidden7Days"))},{default:i(()=>[_(c(n.$t("component.articleManageMenu.forbidden7Days")),1)]),_:1})):y("",!0),e(p)?(u(),g(f,{key:2,onClick:s[3]||(s[3]=k=>m("forbiddenForever"))},{default:i(()=>[_(c(n.$t("component.articleManageMenu.forbiddenForever")),1)]),_:1})):y("",!0)]),_:1})]),_:1})):y("",!0)]),_:1})}}},fe={class:"main"},ge={class:"container main-container left-main side-size-320"},he={class:"left-container space-y-4"},ye={key:0},Me={class:"article-detail"},ve={class:"article-header"},be={class:"article-title-wrapper"},$e={class:"article-title"},we={class:"article-manage-menu"},De={class:"article-meta"},ke={class:"article-meta-item"},Ce=["datetime"],Ae=["innerHTML"],Fe={class:"article-tags"},Te={class:"right-container space-y-4"},xe={__name:"[id]",async setup(F){let l,a;const{t:d}=U(),p=Q(),{data:t,error:M}=([l,a]=W(()=>oe(`/api/article/${p.params.id}`)),l=await l,a(),l);if(M.value)throw X({statusCode:500,message:M.value.message||d("pages.redirect.error")});Y({title:ue(t.value.title)});const v=A(()=>t.value.status===2);return(m,b)=>{const $=B,w=H,n=pe,s=me,D=ce,f=le;return u(),C("section",fe,[o("div",ge,[o("div",he,[e(v)?(u(),C("div",ye,[r(w,null,{default:i(()=>[r($,null,{default:i(()=>[_(c(e(d)("pages.article.detail.pending")),1)]),_:1})]),_:1})])):y("",!0),o("article",Me,[o("div",ve,[o("div",be,[o("h1",$e,c(e(t).title),1),o("div",we,[r(n,{article:e(t)},null,8,["article"])])]),o("div",De,[o("span",ke,[r(s,{to:"/user/"+e(t).user.id,class:"article-author"},{default:i(()=>[_(c(e(t).user.nickname),1)]),_:1},8,["to"]),_(c(e(d)("pages.article.detail.publishedAt"))+" ",1),o("time",{datetime:("useFormatDate"in m?m.useFormatDate:e(Z))(e(t).createTime)},c(("usePrettyDate"in m?m.usePrettyDate:e(ee))(e(t).createTime)),9,Ce)])])]),o("div",{class:"article-content vp-typography line-numbers",innerHTML:e(t).content},null,8,Ae),o("div",Fe,[(u(!0),C(te,null,ne(e(t).tags,h=>(u(),g(s,{key:h.id,to:"/articles/tag/"+h.id,class:"article-tag"},{default:i(()=>[_("#"+c(h.name),1)]),_:2},1032,["to"]))),128))])]),r(D,{"entity-id":e(t).id,"comment-count":e(t).commentCount,"entity-type":"article"},null,8,["entity-id","comment-count"])]),o("div",Te,[r(f,{user:e(t).user},null,8,["user"])])])])}}},yt=R(xe,[["__scopeId","data-v-f427fe5f"]]);export{yt as default};
