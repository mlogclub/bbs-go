import{_ as Q}from"./BN_28Xcu.js";import{_ as R}from"./XKCCBwzU.js";import{m as A,j as ee,g as z,K as B,o as r,c as n,b as e,d as i,w as h,f as x,t as a,e as o,s as $,h as j,F as I,r as N,M as E,D as b,N as te,u as se,C as ae,a as re,O as oe,J as le,v as ne,n as ie,P as de}from"./Ck7AnVGd.js";import{M as G}from"./DhWUe_9n.js";import{C as ce}from"./0crEKJaj.js";import{_ as ue}from"./xrx_K0Wy.js";import{_ as me,a as ge,b as xe,c as pe}from"./BZvBD-TQ.js";import{_ as he}from"./BWHUeAHN.js";import{u as fe}from"./CZ5ckmpo.js";import{L as be}from"./DLPdmiaR.js";import"./CQscZoJ2.js";import"./Bu1jJY3G.js";import"./BNCqmzak.js";import"./CDN07tui.js";import"./BYbIqB-a.js";import"./DJTGgUfV.js";import"./DBLrLi5j.js";import"./CTBG9hF4.js";import"./BP3Ij_Ab.js";import"./QWf4sm8l.js";import"./Q2d2X_pu.js";import"./JWKf8_z1.js";import"./FUKBWQwh.js";import"./Cm3kVkk9.js";import"./CSbzbSNw.js";const U=A("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const ke=A("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const ve=A("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const _e=A("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ye={key:0,class:"rounded-md border border-slate-200/70 bg-white p-4 dark:border-slate-800/80 dark:bg-slate-900 inset-0 bg-linear-to-br from-indigo-50/80 via-white/70 to-emerald-50/80 dark:from-indigo-900/30 dark:via-slate-900/60 dark:to-emerald-900/20"},we={class:"flex items-center gap-3"},$e={class:"min-w-0 flex-1"},Ce={class:"mt-1 text-xs text-slate-500 dark:text-slate-400 line-clamp-2"},Pe={key:0,class:"mt-2 flex flex-wrap items-center justify-between gap-2"},Te={key:0,class:"inline-flex items-center rounded-full bg-amber-50 px-2 py-0.5 text-[11px] font-semibold text-amber-700 dark:bg-amber-900/40 dark:text-amber-100"},Le=["title"],Me=["src","alt"],Ie={key:1,class:"relative mt-4"},Ne={class:"flex items-center justify-between text-[11px] text-slate-500 dark:text-slate-400"},je={class:"font-semibold text-slate-700 dark:text-slate-200"},Se={class:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-200/70 dark:bg-slate-800"},Ue={class:"relative mt-4 grid grid-cols-4 gap-2 text-center"},Ae={class:"rounded-xl bg-white/70 px-2 py-2 text-xs shadow-sm ring-1 ring-slate-100/80 dark:bg-slate-900/70 dark:ring-slate-800"},Fe={class:"text-[11px] text-slate-500 dark:text-slate-400"},Ve={class:"text-sm font-semibold text-slate-900 dark:text-slate-50"},ze={class:"rounded-xl bg-white/70 px-2 py-2 text-xs shadow-sm ring-1 ring-slate-100/80 dark:bg-slate-900/70 dark:ring-slate-800"},Be={class:"text-[11px] text-slate-500 dark:text-slate-400"},De={class:"text-sm font-semibold text-slate-900 dark:text-slate-50"},qe={class:"rounded-xl bg-white/70 px-2 py-2 text-xs shadow-sm ring-1 ring-slate-100/80 dark:bg-slate-900/70 dark:ring-slate-800"},Re={class:"text-[11px] text-slate-500 dark:text-slate-400"},Ee={class:"text-sm font-semibold text-slate-900 dark:text-slate-50"},Ge={class:"rounded-xl bg-white/70 px-2 py-2 text-xs shadow-sm ring-1 ring-slate-100/80 dark:bg-slate-900/70 dark:ring-slate-800"},He={class:"text-[11px] text-slate-500 dark:text-slate-400"},Oe={class:"text-sm font-semibold text-slate-900 dark:text-slate-50"},Ke={class:"relative flex items-center gap-3"},We={class:"min-w-0 flex-1"},Je={class:"text-sm font-semibold text-slate-700 dark:text-slate-200"},Xe={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},Ye={class:"relative inline-flex items-center justify-center rounded-lg bg-indigo-600 px-3 py-2 text-[11px] font-semibold text-white shadow-sm transition hover:bg-indigo-500"},Ze=6,Qe={__name:"TasksUserCard",props:{user:{type:Object,default:null}},async setup(d){let m,v;const g=d,S=ee(),C=b(()=>`/api/badge/badges?userId=${g.user?.id??0}`),{data:F}=([m,v]=z(()=>B(C,{initialCache:!1})),m=await m,v(),m),_=b(()=>g.user?.id?`/user/${g.user.id}/badges`:"#"),V=b(()=>F.value??[]),T=b(()=>V.value.filter(c=>c.owned===!0)),P=b(()=>T.value.slice(0,Ze)),L=()=>{const c=S.fullPath.startsWith("/user/signin")?"/":S.fullPath;te(c)};return(c,y)=>{const w=Q,M=R;return d.user?(r(),n("div",ye,[e("div",we,[i(M,{to:`/user/${d.user.id}`,class:"shrink-0"},{default:h(()=>[i(w,{user:d.user,size:56},null,8,["user"])]),_:1},8,["to"]),e("div",$e,[i(M,{to:`/user/${d.user.id}`,class:"block truncate text-base font-semibold text-slate-900 hover:text-indigo-600 dark:text-slate-50"},{default:h(()=>[x(a(d.user.nickname),1)]),_:1},8,["to"]),e("p",Ce,a(d.user.description||c.$t("user.tasks.userCard.noDescription")),1)])]),d.user.levelTitle||o(T).length>0?(r(),n("div",Pe,[d.user.levelTitle?(r(),n("span",Te,a(d.user.levelTitle),1)):$("",!0),o(T).length>0?(r(),j(M,{key:1,to:o(_),class:"flex flex-wrap items-center transition hover:opacity-90"},{default:h(()=>[(r(!0),n(I,null,N(o(P),f=>(r(),n("span",{key:f.id,title:f.title},[f.icon?(r(),n("img",{key:0,src:f.icon,alt:f.title,class:"h-5 w-5 object-contain"},null,8,Me)):(r(),j(o(G),{key:1,class:"h-3.5 w-3.5 text-amber-600 dark:text-amber-400"}))],8,Le))),128)),i(o(ce),{class:"h-4 w-4 shrink-0 text-slate-400 dark:text-slate-500"})]),_:1},8,["to"])):$("",!0)])):$("",!0),d.user.expProgress?(r(),n("div",Ie,[e("div",Ne,[e("span",null,a(c.$t("user.tasks.userCard.expProgress")),1),e("span",je,a(d.user.expProgress.isMaxLevel?c.$t("user.tasks.userCard.expProgressMaxLevel"):`${d.user.expProgress.expInCurrentLevel} / ${d.user.expProgress.expNeedForNextLevel}`),1)]),e("div",Se,[e("div",{class:"h-full rounded-full bg-gradient-to-r from-indigo-500 via-indigo-500/80 to-emerald-400",style:E({width:d.user.expProgress.expProgressPercent+"%"})},null,4)])])):$("",!0),e("div",Ue,[e("div",Ae,[e("div",Fe,a(c.$t("component.userInfo.score")),1),e("div",Ve,a(d.user.score||0),1)]),e("div",ze,[e("div",Be,a(c.$t("user.tasks.userCard.exp")),1),e("div",De,a(d.user.exp||0),1)]),e("div",qe,[e("div",Re,a(c.$t("component.userInfo.topicCount")),1),e("div",Ee,a(d.user.topicCount||0),1)]),e("div",Ge,[e("div",He,a(c.$t("component.userInfo.commentCount")),1),e("div",Oe,a(d.user.commentCount||0),1)])])])):(r(),n("button",{key:1,type:"button",class:"relative flex w-full flex-col gap-3 overflow-hidden rounded-2xl border border-slate-200/70 bg-white p-4 text-left shadow-sm dark:border-slate-800/80 dark:bg-slate-900",onClick:L},[y[1]||(y[1]=e("div",{class:"pointer-events-none absolute inset-0 bg-gradient-to-br from-indigo-50/80 via-white/70 to-emerald-50/80 dark:from-indigo-900/30 dark:via-slate-900/60 dark:to-emerald-900/20"},null,-1)),e("div",Ke,[y[0]||(y[0]=e("div",{class:"flex h-12 w-12 items-center justify-center rounded-full bg-slate-100 text-base font-semibold text-slate-400 dark:bg-slate-800"}," ? ",-1)),e("div",We,[e("div",Je,a(c.$t("user.tasks.userCard.guestTitle")),1),e("p",Xe,a(c.$t("user.tasks.userCard.guestHint")),1)])]),e("span",Ye,[x(a(c.$t("user.tasks.userCard.signInAction"))+" ",1),i(o(U),{class:"h-3.5 w-3.5"})])]))}}},et={class:"main"},tt={class:"container main-container left-main side-size-320"},st={class:"left-container space-y-4"},at={class:"space-y-4 lg:hidden"},rt={class:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},ot={class:"text-lg font-semibold text-slate-900 dark:text-slate-50"},lt={class:"text-sm text-slate-500 dark:text-slate-400"},nt={class:"flex flex-wrap gap-2 text-xs"},it={class:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2.5 py-1 font-semibold text-slate-700 dark:bg-slate-800 dark:text-slate-100"},dt={class:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2.5 py-1 font-semibold text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-100"},ct={class:"mt-4"},ut={key:0,class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},mt={key:1,class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},gt={class:"relative flex items-start justify-between gap-2.5"},xt={class:"flex items-center gap-3"},pt={class:"space-y-1"},ht={class:"text-[15px] font-semibold text-slate-900 dark:text-slate-50"},ft={class:"relative min-h-[42px] text-[13px] leading-relaxed text-slate-600 dark:text-slate-300 line-clamp-2"},bt={class:"relative flex flex-wrap gap-1.5 text-[11px] text-slate-600 dark:text-slate-300"},kt={key:0,class:"inline-flex items-center gap-1 rounded-full border border-slate-200/80 bg-white/70 px-2 py-0.5 font-semibold text-slate-700 shadow-sm backdrop-blur dark:border-slate-700 dark:bg-slate-800/70 dark:text-slate-100"},vt={key:1,class:"inline-flex items-center gap-1 rounded-full border border-slate-200/80 bg-white/70 px-2 py-0.5 font-semibold text-slate-700 shadow-sm backdrop-blur dark:border-slate-700 dark:bg-slate-800/70 dark:text-slate-100"},_t={key:2,class:"inline-flex items-center gap-1 rounded-full border border-slate-200/80 bg-white/70 px-2 py-0.5 font-semibold text-slate-700 shadow-sm backdrop-blur dark:border-slate-700 dark:bg-slate-800/70 dark:text-slate-100"},yt={class:"relative mt-auto space-y-2.5"},wt={class:"flex items-center justify-between text-[11px] font-medium text-slate-600 dark:text-slate-300"},$t={class:"flex items-center gap-1 font-semibold text-slate-800 dark:text-slate-100"},Ct={class:"h-2 w-full overflow-hidden rounded-full bg-slate-200/80 dark:bg-slate-800"},Pt={class:"flex items-center justify-between gap-3 text-[11px] text-slate-500 dark:text-slate-400"},Tt={class:"truncate"},Lt={class:"flex min-h-[26px] items-center justify-end"},Mt={key:2,class:"inline-flex items-center gap-1 rounded-lg px-2.5 py-1.5 text-[11px] font-semibold opacity-0","aria-hidden":"true"},It={key:2,class:"rounded-xl border border-dashed border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-8 text-center text-slate-600 dark:text-slate-300"},Nt={class:"font-semibold mb-2"},jt={class:"right-container space-y-4 hidden lg:block"},rs={__name:"index",async setup(d){let m,v;const{t:g}=se(),S=ae(),C=b(()=>S.user);re({title:fe(g("user.tasks.title"))});const{data:F}=([m,v]=z(()=>B("/api/task/groups",{initialCache:!1})),m=await m,v(),m),_=ie(""),{data:V,pending:T}=([m,v]=z(()=>B("/api/task/tasks",{initialCache:!1})),m=await m,v(),m),P=b(()=>(F.value||[]).map(s=>{const u=s.key||s.Key||s;return{value:u,label:s.name||s.Name||u}})),L=b(()=>V.value||[]);oe(()=>{!_.value&&P.value.length&&(_.value=P.value[0].value)});const c=b(()=>{const t=L.value,s=t.length,u=t.filter(k=>w(k)).length;return{total:s,completed:u}});function y(t){return!t||t==="all"?L.value:L.value.filter(s=>s.groupName===t)}function w(t){const s=t.userProgress;return s?!!(s.maxFinishCount>0&&s.finishedCount>=s.maxFinishCount||s.eventTarget&&s.eventProgress>=s.eventTarget&&s.maxFinishCount<=1):!1}function M(t){return w(t)?g("user.tasks.status.completed"):t.userProgress&&t.userProgress.eventProgress>0?g("user.tasks.status.inProgress"):g("user.tasks.status.ready")}function f(t){return w(t)?"done":t.userProgress&&t.userProgress.eventProgress>0?"progress":"idle"}function D(t){if(w(t))return 100;const s=t.userProgress,u=s?.eventTarget||t.eventCount||1,k=Math.min(s?.eventProgress||0,u);return Math.min(100,Math.round(k/u*100))}function H(t){const s=t.userProgress;if(!s)return g("user.tasks.progress.notStarted");const u=s.eventTarget||t.eventCount||1,k=w(t)?u:Math.min(s.eventProgress,u);return g("user.tasks.progress.counter",{progress:k,target:u})}function O(t){const s=t.userProgress;return s?s.maxFinishCount>0?g("user.tasks.progress.finishedCount",{count:Math.min(s.finishedCount,s.maxFinishCount),max:s.maxFinishCount}):g("user.tasks.progress.unlimited"):""}function K(){C.value||de()}return(t,s)=>{const u=Qe,k=ue,W=xe,J=ge,q=R,X=pe,Y=me,Z=he;return r(),n("section",et,[e("div",tt,[e("div",st,[e("div",at,[i(u,{user:o(C),"task-stats":o(c)},null,8,["user","task-stats"]),i(k)]),i(Z,null,{default:h(()=>[e("div",rt,[e("div",null,[e("h1",ot,a(t.$t("user.tasks.title")),1),e("p",lt,a(t.$t("user.tasks.subtitle")),1)]),e("div",nt,[e("span",it,[i(o(be),{class:"h-3.5 w-3.5"}),x(" "+a(t.$t("user.tasks.hero.total"))+" "+a(o(c).total),1)]),e("span",dt,[i(o(ke),{class:"h-3.5 w-3.5"}),x(" "+a(t.$t("user.tasks.hero.completed"))+" "+a(o(c).completed),1)])])]),e("div",ct,[i(Y,{modelValue:o(_),"onUpdate:modelValue":s[0]||(s[0]=p=>le(_)?_.value=p:null)},{default:h(()=>[i(J,{"aria-label":"task groups"},{default:h(()=>[(r(!0),n(I,null,N(o(P),p=>(r(),j(W,{key:p.value,value:p.value},{default:h(()=>[e("span",null,a(p.label),1)]),_:2},1032,["value"]))),128))]),_:1}),(r(!0),n(I,null,N(o(P),p=>(r(),j(X,{key:`content-${p.value}`,value:p.value,class:"space-y-3"},{default:h(()=>[o(T)?(r(),n("div",ut,[(r(),n(I,null,N(4,l=>e("div",{key:l,class:"h-36 rounded-xl bg-slate-200 dark:bg-slate-800 animate-pulse"})),64))])):y(p.value).length?(r(),n("div",mt,[(r(!0),n(I,null,N(y(p.value),l=>(r(),n("div",{key:l.id,class:"relative flex flex-col gap-3 overflow-hidden rounded-2xl border border-slate-100/70 bg-white/95 p-3.5 shadow-sm ring-1 ring-transparent transition hover:-translate-y-0.5 hover:shadow-md hover:ring-indigo-100 dark:border-slate-800/80 dark:bg-slate-900/80 dark:ring-slate-800/60"},[s[1]||(s[1]=e("div",{class:"pointer-events-none absolute inset-0 bg-gradient-to-br from-slate-50/80 via-white/70 to-indigo-50/60 dark:from-slate-900/60 dark:via-slate-900/50 dark:to-indigo-900/40"},null,-1)),e("div",gt,[e("div",xt,[e("div",pt,[e("h3",ht,a(l.title),1)])]),e("span",{class:ne(["inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold backdrop-blur",{"border-emerald-300/70 text-emerald-800 bg-emerald-50/90 dark:bg-emerald-900/40 dark:text-emerald-100 dark:border-emerald-700/80":f(l)==="done","border-blue-300/70 text-blue-800 bg-blue-50/90 dark:bg-blue-900/40 dark:text-blue-100 dark:border-blue-700/80":f(l)==="progress","border-slate-300/70 text-slate-700 bg-slate-100/90 dark:bg-slate-800/70 dark:text-slate-100 dark:border-slate-700/80":f(l)==="idle"}])},a(M(l)),3)]),e("p",ft,a(l.description),1),e("div",bt,[l.score?(r(),n("span",kt,[i(o(ve),{class:"h-3.5 w-3.5"}),x(" "+a(t.$t("user.tasks.reward.score",{score:l.score})),1)])):$("",!0),l.exp?(r(),n("span",vt,[i(o(_e),{class:"h-3.5 w-3.5"}),x(" "+a(t.$t("user.tasks.reward.exp",{exp:l.exp})),1)])):$("",!0),l.badgeId?(r(),n("span",_t,[i(o(G),{class:"h-3.5 w-3.5"}),x(" "+a(t.$t("user.tasks.reward.badge")),1)])):$("",!0)]),e("div",yt,[e("div",wt,[e("span",null,a(H(l)),1),e("span",$t,a(D(l))+"% ",1)]),e("div",Ct,[e("div",{class:"h-full rounded-full bg-gradient-to-r from-indigo-500 via-indigo-500/80 to-emerald-400",style:E({width:D(l)+"%"})},null,4)]),e("div",Pt,[e("span",Tt,a(O(l)),1),e("div",Lt,[l.actionUrl&&o(C)?(r(),j(q,{key:0,class:"inline-flex items-center gap-1 rounded-lg bg-slate-900 text-white px-2.5 py-1.5 text-[11px] font-semibold shadow-sm transition hover:-translate-y-0.5 hover:shadow-md hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-500",to:l.actionUrl},{default:h(()=>[i(o(U),{class:"h-3.5 w-3.5"}),x(" "+a(l.btnName||t.$t("user.tasks.actions.go")),1)]),_:2},1032,["to"])):l.actionUrl?(r(),n("button",{key:1,type:"button",class:"inline-flex items-center gap-1 rounded-lg bg-slate-900 text-white px-2.5 py-1.5 text-[11px] font-semibold shadow-sm transition hover:-translate-y-0.5 hover:shadow-md hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-500",onClick:K},[i(o(U),{class:"h-3.5 w-3.5"}),x(" "+a(l.btnName||t.$t("user.tasks.actions.go")),1)])):(r(),n("span",Mt,[i(o(U),{class:"h-3.5 w-3.5"}),x(" "+a(t.$t("user.tasks.actions.go")),1)]))])])])]))),128))])):(r(),n("div",It,[s[2]||(s[2]=e("div",{class:"text-3xl mb-2"},"ðŸª",-1)),e("div",Nt,a(t.$t("user.tasks.emptyTitle")),1),i(q,{class:"inline-flex items-center rounded-lg bg-indigo-600 text-white px-4 py-2 text-sm font-semibold hover:bg-indigo-500 transition",to:"/"},{default:h(()=>[x(a(t.$t("user.tasks.emptyAction")),1)]),_:1})]))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),e("div",jt,[i(u,{user:o(C),"task-stats":o(c)},null,8,["user","task-stats"]),i(k)])])])}}};export{rs as default};
