import{_ as W,A as $}from"./B2yB216K.js";import{_ as Z}from"./BsCzhM_a.js";import{_ as Q,a as X,b as Y,c as ee}from"./Myp_MH4T.js";import{_ as te}from"./UwGaH15d.js";import{_ as se}from"./DYGa34Qb.js";import{m as M,u as ae,C as re,a as oe,g as S,M as ne,o,c as d,b as s,d as n,w as f,t as r,e as l,f as u,J as le,F as v,r as k,h as P,v as ie,s as T,N as de,K as A,D as y,n as ce,O as ue}from"./IMHBmAvM.js";import{u as pe}from"./DJY5Y4zn.js";import{L as me}from"./D0BufwKL.js";import{M as ge}from"./Doo5uwP7.js";import"./BptVNsbJ.js";import"./Dy4Z_VQo.js";import"./DWG3xSCv.js";import"./DmwfaKwn.js";import"./BZY-t1L7.js";import"./BOEcqi2e.js";import"./BXIDeL47.js";import"./CWBW37gM.js";import"./CboA2NrW.js";import"./GHR_VWTl.js";import"./Cop6u61-.js";import"./B1wiTl2V.js";import"./mWIteSzr.js";import"./FUKBWQwh.js";import"./lfLn7L41.js";import"./DDHZDh0S.js";const fe=M("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const he=M("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const be=M("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),xe={class:"main"},_e={class:"container main-container left-main side-size-320"},ve={class:"left-container space-y-4"},ke={class:"space-y-4 lg:hidden"},ye={class:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},we={class:"text-lg font-semibold text-slate-900 dark:text-slate-50"},Ce={class:"text-sm text-slate-500 dark:text-slate-400"},$e={class:"flex flex-wrap gap-2 text-xs"},Pe={class:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2.5 py-1 font-semibold text-slate-700 dark:bg-slate-800 dark:text-slate-100"},Te={class:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2.5 py-1 font-semibold text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-100"},Me={class:"mt-4"},Fe={key:0,class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},Le={key:1,class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},Ne={class:"relative flex items-start justify-between gap-2.5"},Ue={class:"flex items-center gap-3"},Ve={class:"space-y-1"},Se={class:"text-[15px] font-semibold text-slate-900 dark:text-slate-50"},Ae={class:"relative min-h-[42px] text-[13px] leading-relaxed text-slate-600 dark:text-slate-300 line-clamp-2"},ze={class:"relative flex flex-wrap gap-1.5 text-[11px] text-slate-600 dark:text-slate-300"},je={key:0,class:"inline-flex items-center gap-1 rounded-full border border-slate-200/80 bg-white/70 px-2 py-0.5 font-semibold text-slate-700 shadow-sm backdrop-blur dark:border-slate-700 dark:bg-slate-800/70 dark:text-slate-100"},Be={key:1,class:"inline-flex items-center gap-1 rounded-full border border-slate-200/80 bg-white/70 px-2 py-0.5 font-semibold text-slate-700 shadow-sm backdrop-blur dark:border-slate-700 dark:bg-slate-800/70 dark:text-slate-100"},Ie={key:2,class:"inline-flex items-center gap-1 rounded-full border border-slate-200/80 bg-white/70 px-2 py-0.5 font-semibold text-slate-700 shadow-sm backdrop-blur dark:border-slate-700 dark:bg-slate-800/70 dark:text-slate-100"},qe={class:"relative mt-auto space-y-2.5"},De={class:"flex items-center justify-between text-[11px] font-medium text-slate-600 dark:text-slate-300"},Ee={class:"flex items-center gap-1 font-semibold text-slate-800 dark:text-slate-100"},Ge={class:"h-2 w-full overflow-hidden rounded-full bg-slate-200/80 dark:bg-slate-800"},He={class:"flex items-center justify-between gap-3 text-[11px] text-slate-500 dark:text-slate-400"},Ke={class:"truncate"},Oe={class:"flex min-h-[26px] items-center justify-end"},Re={key:2,class:"inline-flex items-center gap-1 rounded-lg px-2.5 py-1.5 text-[11px] font-semibold opacity-0","aria-hidden":"true"},Je={key:2,class:"rounded-xl border border-dashed border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-8 text-center text-slate-600 dark:text-slate-300"},We={class:"font-semibold mb-2"},Ze={class:"right-container space-y-4 hidden lg:block"},wt={__name:"index",async setup(Qe){let p,x;const{t:m}=ae(),z=re(),F=y(()=>z.user);oe({title:pe(m("user.tasks.title"))});const{data:j}=([p,x]=S(()=>A("/api/task/groups",{initialCache:!1})),p=await p,x(),p),h=ce(""),{data:B,pending:I}=([p,x]=S(()=>A("/api/task/tasks",{initialCache:!1})),p=await p,x(),p),_=y(()=>(j.value||[]).map(t=>{const i=t.key||t.Key||t;return{value:i,label:t.name||t.Name||i}})),w=y(()=>B.value||[]);ne(()=>{!h.value&&_.value.length&&(h.value=_.value[0].value)});const L=y(()=>{const e=w.value,t=e.length,i=e.filter(g=>b(g)).length;return{total:t,completed:i}});function N(e){return!e||e==="all"?w.value:w.value.filter(t=>t.groupName===e)}function b(e){const t=e.userProgress;return t?!!(t.maxFinishCount>0&&t.finishedCount>=t.maxFinishCount||t.eventTarget&&t.eventProgress>=t.eventTarget&&t.maxFinishCount<=1):!1}function q(e){return b(e)?m("user.tasks.status.completed"):e.userProgress&&e.userProgress.eventProgress>0?m("user.tasks.status.inProgress"):m("user.tasks.status.ready")}function C(e){return b(e)?"done":e.userProgress&&e.userProgress.eventProgress>0?"progress":"idle"}function U(e){if(b(e))return 100;const t=e.userProgress,i=t?.eventTarget||e.eventCount||1,g=Math.min(t?.eventProgress||0,i);return Math.min(100,Math.round(g/i*100))}function D(e){const t=e.userProgress;if(!t)return m("user.tasks.progress.notStarted");const i=t.eventTarget||e.eventCount||1,g=b(e)?i:Math.min(t.eventProgress,i);return m("user.tasks.progress.counter",{progress:g,target:i})}function E(e){const t=e.userProgress;return t?t.maxFinishCount>0?m("user.tasks.progress.finishedCount",{count:Math.min(t.finishedCount,t.maxFinishCount),max:t.maxFinishCount}):m("user.tasks.progress.unlimited"):""}function G(){F.value||ue()}return(e,t)=>{const i=W,g=Z,H=Y,K=X,V=te,O=ee,R=Q,J=se;return o(),d("section",xe,[s("div",_e,[s("div",ve,[s("div",ke,[n(i),n(g)]),n(J,null,{default:f(()=>[s("div",ye,[s("div",null,[s("h1",we,r(e.$t("user.tasks.title")),1),s("p",Ce,r(e.$t("user.tasks.subtitle")),1)]),s("div",$e,[s("span",Pe,[n(l(me),{class:"h-3.5 w-3.5"}),u(" "+r(e.$t("user.tasks.hero.total"))+" "+r(l(L).total),1)]),s("span",Te,[n(l(fe),{class:"h-3.5 w-3.5"}),u(" "+r(e.$t("user.tasks.hero.completed"))+" "+r(l(L).completed),1)])])]),s("div",Me,[n(R,{modelValue:l(h),"onUpdate:modelValue":t[0]||(t[0]=c=>le(h)?h.value=c:null)},{default:f(()=>[n(K,{"aria-label":"task groups"},{default:f(()=>[(o(!0),d(v,null,k(l(_),c=>(o(),P(H,{key:c.value,value:c.value},{default:f(()=>[s("span",null,r(c.label),1)]),_:2},1032,["value"]))),128))]),_:1}),(o(!0),d(v,null,k(l(_),c=>(o(),P(O,{key:`content-${c.value}`,value:c.value,class:"space-y-3"},{default:f(()=>[l(I)?(o(),d("div",Fe,[(o(),d(v,null,k(4,a=>s("div",{key:a,class:"h-36 rounded-xl bg-slate-200 dark:bg-slate-800 animate-pulse"})),64))])):N(c.value).length?(o(),d("div",Le,[(o(!0),d(v,null,k(N(c.value),a=>(o(),d("div",{key:a.id,class:"relative flex flex-col gap-3 overflow-hidden rounded-2xl border border-slate-100/70 bg-white/95 p-3.5 shadow-sm ring-1 ring-transparent transition hover:-translate-y-0.5 hover:shadow-md hover:ring-indigo-100 dark:border-slate-800/80 dark:bg-slate-900/80 dark:ring-slate-800/60"},[t[1]||(t[1]=s("div",{class:"pointer-events-none absolute inset-0 bg-gradient-to-br from-slate-50/80 via-white/70 to-indigo-50/60 dark:from-slate-900/60 dark:via-slate-900/50 dark:to-indigo-900/40"},null,-1)),s("div",Ne,[s("div",Ue,[s("div",Ve,[s("h3",Se,r(a.title),1)])]),s("span",{class:ie(["inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold backdrop-blur",{"border-emerald-300/70 text-emerald-800 bg-emerald-50/90 dark:bg-emerald-900/40 dark:text-emerald-100 dark:border-emerald-700/80":C(a)==="done","border-blue-300/70 text-blue-800 bg-blue-50/90 dark:bg-blue-900/40 dark:text-blue-100 dark:border-blue-700/80":C(a)==="progress","border-slate-300/70 text-slate-700 bg-slate-100/90 dark:bg-slate-800/70 dark:text-slate-100 dark:border-slate-700/80":C(a)==="idle"}])},r(q(a)),3)]),s("p",Ae,r(a.description),1),s("div",ze,[a.score?(o(),d("span",je,[n(l(he),{class:"h-3.5 w-3.5"}),u(" "+r(e.$t("user.tasks.reward.score",{score:a.score})),1)])):T("",!0),a.exp?(o(),d("span",Be,[n(l(be),{class:"h-3.5 w-3.5"}),u(" "+r(e.$t("user.tasks.reward.exp",{exp:a.exp})),1)])):T("",!0),a.badgeId?(o(),d("span",Ie,[n(l(ge),{class:"h-3.5 w-3.5"}),u(" "+r(e.$t("user.tasks.reward.badge")),1)])):T("",!0)]),s("div",qe,[s("div",De,[s("span",null,r(D(a)),1),s("span",Ee,r(U(a))+"% ",1)]),s("div",Ge,[s("div",{class:"h-full rounded-full bg-gradient-to-r from-indigo-500 via-indigo-500/80 to-emerald-400",style:de({width:U(a)+"%"})},null,4)]),s("div",He,[s("span",Ke,r(E(a)),1),s("div",Oe,[a.actionUrl&&l(F)?(o(),P(V,{key:0,class:"inline-flex items-center gap-1 rounded-lg bg-slate-900 text-white px-2.5 py-1.5 text-[11px] font-semibold shadow-sm transition hover:-translate-y-0.5 hover:shadow-md hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-500",to:a.actionUrl},{default:f(()=>[n(l($),{class:"h-3.5 w-3.5"}),u(" "+r(a.btnName||e.$t("user.tasks.actions.go")),1)]),_:2},1032,["to"])):a.actionUrl?(o(),d("button",{key:1,type:"button",class:"inline-flex items-center gap-1 rounded-lg bg-slate-900 text-white px-2.5 py-1.5 text-[11px] font-semibold shadow-sm transition hover:-translate-y-0.5 hover:shadow-md hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-500",onClick:G},[n(l($),{class:"h-3.5 w-3.5"}),u(" "+r(a.btnName||e.$t("user.tasks.actions.go")),1)])):(o(),d("span",Re,[n(l($),{class:"h-3.5 w-3.5"}),u(" "+r(e.$t("user.tasks.actions.go")),1)]))])])])]))),128))])):(o(),d("div",Je,[t[2]||(t[2]=s("div",{class:"text-3xl mb-2"},"ðŸª",-1)),s("div",We,r(e.$t("user.tasks.emptyTitle")),1),n(V,{class:"inline-flex items-center rounded-lg bg-indigo-600 text-white px-4 py-2 text-sm font-semibold hover:bg-indigo-500 transition",to:"/"},{default:f(()=>[u(r(e.$t("user.tasks.emptyAction")),1)]),_:1})]))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),s("div",Ze,[n(i),n(g)])])])}}};export{wt as default};
