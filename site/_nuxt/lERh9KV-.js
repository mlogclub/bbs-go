import{a as B,_ as N}from"./BT-mllKq.js";import{j as x,u as M,a as S,o as m,c as T,b as d,d as r,w as o,t as l,e,h as b,f as c,s as k,R as U,Q as q,n as R,z as A,A as C,B as E,E as D}from"./IMHBmAvM.js";import{_ as H}from"./nHyB59Vm.js";import{_ as I}from"./HzVF1qNI.js";import{_ as L}from"./UwGaH15d.js";import{_ as j}from"./DYGa34Qb.js";import{u as z}from"./DJY5Y4zn.js";import"./iGIsgRmF.js";import"./BZY-t1L7.js";import"./DmwfaKwn.js";const F={class:"main"},J={class:"container"},Q={class:"main-body no-bg"},W={class:"text-xl font-semibold mb-6"},G={class:"mt-6 text-center"},ne={__name:"reset",setup(K){const g=x(),{t:n}=M(),h=String(g.query.token||"").trim();S({title:z(n("user.passwordReset.reset.title"))});const u=R(!1),i=R(!1),a=R(""),s=q({token:h,password:"",rePassword:""}),y=async()=>{if(a.value="",!s.token){a.value=n("user.passwordReset.reset.tokenMissing");return}if(!s.password){a.value=n("user.passwordReset.reset.passwordRequired");return}if(!s.rePassword){a.value=n("user.passwordReset.reset.rePasswordRequired");return}if(s.password!==s.rePassword){a.value=n("user.passwordReset.reset.passwordMismatch");return}u.value=!0;try{await A("/api/login/reset_password",C(s)),i.value=!0,E(n("user.passwordReset.reset.successNotice")),setTimeout(()=>{D("/user/signin")},1200)}catch(t){a.value=t?.message||n("composables.unknownError")}finally{u.value=!1}};return(t,p)=>{const _=N,w=B,v=H,$=I,P=L,V=j;return m(),T("section",F,[d("div",J,[d("div",Q,[r(V,{class:"max-w-160 mx-auto"},{default:o(()=>[d("h2",W,l(t.$t("user.passwordReset.reset.title")),1),e(s).token?k("",!0):(m(),b(w,{key:0,variant:"destructive",class:"mb-4"},{default:o(()=>[r(_,null,{default:o(()=>[c(l(t.$t("user.passwordReset.reset.tokenMissing")),1)]),_:1})]),_:1})),e(a)?(m(),b(w,{key:1,variant:"destructive",class:"mb-4"},{default:o(()=>[r(_,null,{default:o(()=>[c(l(e(a)),1)]),_:1})]),_:1})):k("",!0),d("form",{class:"space-y-4",onSubmit:U(y,["prevent"])},[r(v,{modelValue:e(s).password,"onUpdate:modelValue":p[0]||(p[0]=f=>e(s).password=f),type:"password",placeholder:t.$t("user.passwordReset.reset.passwordPlaceholder"),disabled:!e(s).token||e(u)||e(i)},null,8,["modelValue","placeholder","disabled"]),r(v,{modelValue:e(s).rePassword,"onUpdate:modelValue":p[1]||(p[1]=f=>e(s).rePassword=f),type:"password",placeholder:t.$t("user.passwordReset.reset.rePasswordPlaceholder"),disabled:!e(s).token||e(u)||e(i)},null,8,["modelValue","placeholder","disabled"]),r($,{type:"submit",class:"w-full",disabled:!e(s).token||e(u)||e(i)},{default:o(()=>[c(l(e(u)?t.$t("user.passwordReset.reset.submitting"):t.$t("user.passwordReset.reset.submitButton")),1)]),_:1},8,["disabled"])],32),e(i)?(m(),b(w,{key:2,class:"mt-4"},{default:o(()=>[r(_,null,{default:o(()=>[c(l(t.$t("user.passwordReset.reset.successNotice")),1)]),_:1})]),_:1})):k("",!0),d("div",G,[r(P,{to:"/user/signin",class:"text-sm text-primary"},{default:o(()=>[c(l(t.$t("user.passwordReset.backToSignin")),1)]),_:1})])]),_:1})])])])}}};export{ne as default};
