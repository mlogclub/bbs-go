import{_ as A,a as T}from"./BHlYvgvh.js";import{_ as N}from"./COnyVYXM.js";import{_ as P}from"./qdLMPJJp.js";import{_ as x}from"./DepVQ0hq.js";import{_ as z,a as D}from"./BeCz0hYA.js";import{_ as F}from"./CmgyteDV.js";import{_ as H}from"./Lz5MK4XN.js";import{_ as I,u as J,C as M,k as j,ag as G,a as L,l as O,o as p,c as g,b as t,e as s,h as u,w as l,d as i,f as d,t as n,v,D as q,n as h,z as K,A as Q,G as R,E as W,H as X}from"./BqKV1jHe.js";import{u as Y}from"./DjqtQ0rA.js";import{P as Z}from"./D0_pkkCJ.js";import"./CDN07tui.js";import"./B_DlFklR.js";import"./DM7nVvhd.js";import"./Co6smBZm.js";import"./Cw0ACwvr.js";import"./2IywVXlI.js";import"./NrFrN4Pt.js";import"./rOZs_Z5q.js";import"./BVwgWqD4.js";import"./C7TzAs_Y.js";import"./C6Y-ieo6.js";import"./C_7uZ5Li.js";import"./wswtc-47.js";import"./dLNci5L_.js";import"./BMShvsNX.js";import"./DyiL-6dj.js";import"./ByVerKeN.js";import"./DHvowL4P.js";import"./hn3dWTqe.js";import"./CGCSZgC7.js";import"./CcFcSr0Z.js";import"./Dw_9k8Cy.js";import"./DzCyRy98.js";import"./BpT8Lfr7.js";import"./C-WSYw8B.js";import"./DKk2Wjmd.js";import"./FUKBWQwh.js";import"./B3dDHzJ7.js";import"./Bdij4vm2.js";const ee={class:"main"},te={class:"container"},oe={key:1,class:"publish-form"},se={class:"form-title"},ae={class:"form-title-name"},ie={class:"field"},re={class:"control"},le={class:"field"},ne={class:"control"},ce={class:"field"},me={class:"control"},pe={class:"field"},de={class:"control"},_e={class:"cover-add-btn"},ue={class:"form-footer"},fe={__name:"create",setup(ge){const{t:m}=J(),c=h(!1),e=h({title:"",tags:[],content:""}),V=M(),_=j(),$=q(()=>_.config.createArticleEmailVerified&&!V.user.emailVerified);if(_.config.modules.article||G(m("pages.article.create.featureClosed")),L({title:Y(m("pages.article.create.title"))}),!_.isEnabledArticle)throw O({statusCode:403,message:m("pages.article.create.featureForbidden")});async function y(){if(!c.value){c.value=!0;try{const o=await K("/api/article/create",Q({title:e.value.title,content:e.value.content,tags:e.value.tags?e.value.tags.join(","):"",cover:e.value.cover&&e.value.cover.length?JSON.stringify(e.value.cover[0]):null}));R({message:m("pages.article.create.success"),onClose(){W(`/article/${o.id}`)}})}catch(o){X(o.message||m("pages.article.create.error")),c.value=!1}}}return(o,a)=>{const b=N,k=P,E=A,U=T,C=x,B=z,w=D,S=F,f=H;return p(),g("section",ee,[t("div",te,[s($)?(p(),u(U,{key:0},{default:l(()=>[i(b,null,{default:l(()=>[d(n(o.$t("pages.article.create.needEmailTitle")),1)]),_:1}),i(E,null,{default:l(()=>[d(n(o.$t("pages.article.create.needEmailBody"))+" ",1),i(k,{to:"/user/profile/account",style:{color:"var(--primary)"}},{default:l(()=>[d(n(o.$t("pages.article.create.goVerify")),1)]),_:1})]),_:1})]),_:1})):(p(),g("div",oe,[t("div",se,[t("div",ae,n(o.$t("pages.article.create.title")),1)]),t("div",ie,[t("div",re,[i(C,{modelValue:s(e).title,"onUpdate:modelValue":a[0]||(a[0]=r=>s(e).title=r),type:"text",placeholder:o.$t("pages.article.create.titlePlaceholder")},null,8,["modelValue","placeholder"])])]),t("div",le,[t("div",ne,[i(B,{modelValue:s(e).content,"onUpdate:modelValue":a[1]||(a[1]=r=>s(e).content=r),placeholder:o.$t("pages.article.create.contentPlaceholder")},null,8,["modelValue","placeholder"])])]),t("div",ce,[t("div",me,[i(w,{modelValue:s(e).tags,"onUpdate:modelValue":a[2]||(a[2]=r=>s(e).tags=r)},null,8,["modelValue"])])]),t("div",pe,[t("div",de,[i(S,{modelValue:s(e).cover,"onUpdate:modelValue":a[3]||(a[3]=r=>s(e).cover=r),limit:1,size:"120px"},{"add-image-button":l(()=>[t("div",_e,[i(s(Z),{class:"cover-add-icon h-[18px] w-[18px]"}),t("span",null,n(o.$t("pages.article.create.cover")),1)])]),_:1},8,["modelValue"])])]),t("div",ue,[s(c)?(p(),u(f,{key:0,class:v({"is-loading":s(c)}),disabled:""},{default:l(()=>[d(n(o.$t("pages.article.create.publishBtn")),1)]),_:1},8,["class"])):(p(),u(f,{key:1,class:v({"is-loading":s(c)}),onClick:y},{default:l(()=>[d(n(o.$t("pages.article.create.publishBtn")),1)]),_:1},8,["class"]))])]))])])}}},ot=I(fe,[["__scopeId","data-v-db980912"]]);export{ot as default};
