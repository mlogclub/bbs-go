import{r as g}from"./De4aO46H.js";import{n as f,p as y,T as w,ac as I,D as O,X as S,a5 as U,W as C,aJ as P}from"./CJzXP6Za.js";import{h as b,i as D,a as _}from"./2CCwYrQ6.js";function x(o,e){const s=f(o);function l(r){return e[s.value][r]??s.value}return{state:s,dispatch:r=>{s.value=l(r)}}}function F(o,e){const s=f({}),l=f("none"),v=f(o),r=o.value?"mounted":"unmounted";let u;const c=e.value?.ownerDocument.defaultView??b,{state:m,dispatch:a}=x(r,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),n=t=>{if(D){const i=new CustomEvent(t,{bubbles:!1,cancelable:!1});e.value?.dispatchEvent(i)}};y(o,async(t,i)=>{const h=i!==t;if(await w(),h){const A=l.value,d=N(e.value);t?(a("MOUNT"),n("enter"),d==="none"&&n("after-enter")):d==="none"||d==="undefined"||s.value?.display==="none"?(a("UNMOUNT"),n("leave"),n("after-leave")):i&&A!==d?(a("ANIMATION_OUT"),n("leave")):(a("UNMOUNT"),n("after-leave"))}},{immediate:!0});const p=t=>{const i=N(e.value),h=i.includes(CSS.escape(t.animationName)),A=m.value==="mounted"?"enter":"leave";if(t.target===e.value&&h&&(n(`after-${A}`),a("ANIMATION_END"),!v.value)){const d=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",u=c?.setTimeout(()=>{e.value?.style.animationFillMode==="forwards"&&(e.value.style.animationFillMode=d)})}t.target===e.value&&i==="none"&&a("ANIMATION_END")},M=t=>{t.target===e.value&&(l.value=N(e.value))},E=y(e,(t,i)=>{t?(s.value=getComputedStyle(t),t.addEventListener("animationstart",M),t.addEventListener("animationcancel",p),t.addEventListener("animationend",p)):(a("ANIMATION_END"),u!==void 0&&c?.clearTimeout(u),i?.removeEventListener("animationstart",M),i?.removeEventListener("animationcancel",p),i?.removeEventListener("animationend",p))},{immediate:!0}),T=y(m,()=>{const t=N(e.value);l.value=m.value==="mounted"?t:"none"});return I(()=>{E(),T()}),{isPresent:O(()=>["mounted","unmountSuspended"].includes(m.value))}}function N(o){return o&&getComputedStyle(o).animationName||"none"}var j=S({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(o,{slots:e,expose:s}){const{present:l,forceMount:v}=U(o),r=f(),{isPresent:u}=F(l,r);s({present:u});let c=e.default({present:u.value});c=g(c||[]);const m=P();if(c&&c?.length>1){const a=m?.parent?.type.name?`<${m.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${a}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(n=>`  - ${n}`).join(`
`)].join(`
`))}return()=>v.value||l.value||u.value?C(e.default({present:u.value})[0],{ref:a=>{const n=_(a);return typeof n?.hasAttribute>"u"||(n?.hasAttribute("data-reka-popper-content-wrapper")?r.value=n.firstElementChild:r.value=n),n}}):null}});export{j as P,x as u};
