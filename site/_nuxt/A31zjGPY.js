import{m as H,u as j,q as O,p as F,S as X,o as l,c as p,d as N,w,b as x,t as k,e as a,h as L,v as B,f as R,J as T,F as U,r as A,s as M,ae as Y,n as C,D as u,_ as Z,ad as e0}from"./BqKV1jHe.js";import{_ as t0}from"./Lz5MK4XN.js";import{_ as a0,a as s0,b as o0,c as n0}from"./DtFo4L66.js";import{_ as l0}from"./DepVQ0hq.js";import{_ as r0}from"./D-IVPkF3.js";import{C as i0}from"./8kSMhTPi.js";const c0=H("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);const M0=H("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),d0={class:"node-selector"},u0={class:"truncate"},m0={class:"space-y-3"},p0={key:0,class:"space-y-2"},v0={class:"text-xs text-muted-foreground"},h0={class:"flex flex-wrap gap-2"},f0=["data-node-id","data-selected","onClick"],g0={class:"truncate"},_0={key:0,class:"px-2 py-6 text-center text-sm text-muted-foreground"},q="bbsgo-recent-topic-node-ids",y0=5,b0={__name:"TopicNodeSelector",props:{modelValue:{type:Number,default:0},nodes:{type:Array,default:()=>[]},triggerFullWidth:{type:Boolean,default:!0},triggerSize:{type:String,default:"default"},triggerLabel:{type:String,default:""},triggerIcon:{type:String,default:"down"}},emits:["update:modelValue"],setup(S,{emit:I}){const r=S,$=I,{t:_}=j(),m=C(!1),n=C(""),o=C([]),V=C(null),v=u(()=>Array.isArray(r.nodes)?r.nodes:[]),D=u(()=>r.triggerFullWidth?"h-10 w-full justify-between px-3":"h-6 justify-between px-3"),E=u(()=>{const e=Number(r.modelValue);return v.value.find(t=>Number(t.id)===e)}),z=u(()=>r.triggerLabel||E.value?.name||_("pages.topic.nodeSelector.choose")),h=u(()=>{const e=n.value.trim().toLowerCase();return e?v.value.filter(t=>String(t.name||"").toLowerCase().includes(e)):v.value}),c=u(()=>{if(!o.value.length)return[];const e=new Map(v.value.map(t=>[Number(t.id),t]));return o.value.map(t=>e.get(Number(t))).filter(Boolean)}),f=e=>Number(r.modelValue)===Number(e),d=()=>{localStorage.setItem(q,JSON.stringify(o.value))},g=e=>{const t=Number(e),i=o.value.filter(b=>Number(b)!==t);i.unshift(t),o.value=i.slice(0,y0),d()},y=e=>{$("update:modelValue",Number(e.id)),g(e.id),m.value=!1},J=()=>{if(!V.value)return;const e=V.value.querySelector('button[data-selected="true"]');e&&e.scrollIntoView({behavior:"smooth",block:"center"})};return O(()=>{try{const e=localStorage.getItem(q);if(!e)return;const t=JSON.parse(e);Array.isArray(t)&&(o.value=t.map(i=>Number(i)).filter(i=>Number.isFinite(i)))}catch{o.value=[]}}),F(()=>v.value,e=>{const t=new Set(e.map(b=>Number(b.id))),i=o.value.filter(b=>t.has(Number(b)));i.length!==o.value.length&&(o.value=i,d())},{immediate:!0}),F(m,e=>{if(!e){n.value="";return}X(()=>{requestAnimationFrame(()=>{J()})})}),(e,t)=>{const i=t0,b=o0,Q=s0,W=l0,K=a0,P=n0;return l(),p("div",d0,[N(i,{type:"button",variant:"outline",size:S.triggerSize,class:B(a(D)),onClick:t[0]||(t[0]=s=>m.value=!0)},{default:w(()=>[x("span",u0,k(a(z)),1),S.triggerIcon==="right"?(l(),L(a(i0),{key:0,class:"h-4 w-4 opacity-70"})):(l(),L(a(c0),{key:1,class:"h-4 w-4 opacity-60"}))]),_:1},8,["size","class"]),N(P,{open:a(m),"onUpdate:open":t[2]||(t[2]=s=>T(m)?m.value=s:null)},{default:w(()=>[N(K,{class:"sm:max-w-lg"},{default:w(()=>[N(Q,null,{default:w(()=>[N(b,null,{default:w(()=>[R(k(a(_)("pages.topic.nodeSelector.title")),1)]),_:1})]),_:1}),x("div",m0,[N(W,{modelValue:a(n),"onUpdate:modelValue":t[1]||(t[1]=s=>T(n)?n.value=s:null),placeholder:a(_)("pages.topic.nodeSelector.searchPlaceholder")},null,8,["modelValue","placeholder"]),a(c).length?(l(),p("div",p0,[x("div",v0,k(a(_)("pages.topic.nodeSelector.recent")),1),x("div",h0,[(l(!0),p(U,null,A(a(c),s=>(l(),L(i,{key:`recent-${s.id}`,type:"button",size:"sm",variant:f(s.id)?"default":"secondary",onClick:G=>y(s)},{default:w(()=>[R(k(s.name),1)]),_:2},1032,["variant","onClick"]))),128))])])):M("",!0),N(a(r0),{class:"h-72 rounded-md border"},{default:w(()=>[x("div",{ref_key:"listRef",ref:V,class:"p-2"},[(l(!0),p(U,null,A(a(h),s=>(l(),p("button",{key:s.id,type:"button","data-node-id":s.id,"data-selected":f(s.id),class:B(["flex w-full items-center justify-between rounded-md px-2 py-2 text-left text-sm transition-colors hover:bg-muted",f(s.id)?"bg-muted text-primary":""]),onClick:G=>y(s)},[x("span",g0,k(s.name),1),f(s.id)?(l(),L(a(Y),{key:0,class:"ml-2 h-4 w-4 shrink-0"})):M("",!0)],10,f0))),128)),a(h).length?M("",!0):(l(),p("div",_0,k(a(_)("pages.topic.nodeSelector.empty")),1))],512)]),_:1})])]),_:1})]),_:1},8,["open"])])}}},N0={class:"topic-tags"},w0=["onClick"],x0={__name:"TopicNodeQuickSelector",props:{modelValue:{type:Number,default:0},nodes:{type:Array,default:()=>[]},mobileLimit:{type:Number,default:4},desktopLimit:{type:Number,default:8}},emits:["update:modelValue"],setup(S,{emit:I}){const r=S,$=I,{t:_}=j(),m=C(!1);let n=null;const o=u(()=>Array.isArray(r.nodes)?r.nodes:[]),V=u(()=>m.value?r.mobileLimit:r.desktopLimit),v=u(()=>o.value.length>V.value),D=u(()=>{if(!v.value)return o.value;const c=Number(r.modelValue),f=o.value.find(y=>Number(y.id)===c),d=o.value.slice(0,V.value),g=d.some(y=>Number(y.id)===c);return f&&!g&&d.length>0&&(d[d.length-1]=f),d}),E=c=>Number(r.modelValue)===Number(c),z=c=>{$("update:modelValue",Number(c))},h=()=>{m.value=!!n?.matches};return O(()=>{if(n=window.matchMedia("(max-width: 639px)"),h(),n.addEventListener){n.addEventListener("change",h);return}n.addListener(h)}),e0(()=>{if(n){if(n.removeEventListener){n.removeEventListener("change",h);return}n.removeListener(h)}}),(c,f)=>{const d=b0;return l(),p("div",N0,[(l(!0),p(U,null,A(a(D),g=>(l(),p("div",{key:g.id,class:B(["topic-tag",{selected:E(g.id)}]),onClick:y=>z(g.id)},[x("span",null,k(g.name),1)],10,w0))),128)),a(v)?(l(),L(d,{key:0,"model-value":S.modelValue,nodes:a(o),"trigger-full-width":!1,"trigger-size":"sm","trigger-label":a(_)("pages.topic.nodeSelector.more"),"trigger-icon":"right","onUpdate:modelValue":z},null,8,["model-value","nodes","trigger-label"])):M("",!0)])}}},I0=Object.assign(Z(x0,[["__scopeId","data-v-01aad925"]]),{__name:"TopicNodeQuickSelector"}),$0="data:image/svg+xml,%3csvg%20t='1748437227704'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5708'%20width='200'%20height='200'%3e%3cpath%20d='M854.6%20288.7c6%206%209.4%2014.1%209.4%2022.6V928c0%2017.7-14.3%2032-32%2032H192c-17.7%200-32-14.3-32-32V96c0-17.7%2014.3-32%2032-32h424.7c8.5%200%2016.7%203.4%2022.7%209.4l215.2%20215.3zM790.2%20326L602%20137.8V326h188.2zM426.13%20600.93l59.11%20132.975a16.003%2016.003%200%200%200%2014.624%209.503h24.055c6.33%200%2012.065-3.732%2014.63-9.518l59.109-133.35v157.458c0%208.838%207.165%2016.003%2016.003%2016.003h27.337c8.838%200%2016.003-7.165%2016.003-16.003V486.002c0-8.838-7.165-16.003-16.003-16.003h-34.746a16.003%2016.003%200%200%200-14.673%209.616l-79.473%20182.587-79.473-182.587A16.003%2016.003%200%200%200%20417.96%20470h-34.958c-8.838%200-16.003%207.165-16.003%2016.003v271.996c0%208.838%207.165%2016.003%2016.003%2016.003h27.126c8.838%200%2016.003-7.165%2016.003-16.003v-157.07z'%20fill='%231296DB'%20p-id='5709'%3e%3c/path%3e%3c/svg%3e",D0="data:image/svg+xml,%3csvg%20t='1748437194990'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5551'%20width='200'%20height='200'%3e%3cpath%20d='M847.872%20240.128v688c0%2026.56-21.408%2048-48%2048h-576c-26.56%200-48-21.44-48-48v-832c0-26.592%2021.44-48%2048-48h432z'%20fill='%23E9EDED'%20p-id='5552'%3e%3c/path%3e%3cpath%20d='M160%20768.128v160c0%2035.456%2028.544%2064%2064%2064h576c35.456%200%2064-28.544%2064-64v-160H160z'%20fill='%23F05542'%20p-id='5553'%3e%3c/path%3e%3cpath%20d='M847.872%20240.128h-144c-26.56%200-48-21.44-48-48v-144'%20fill='%23F05542'%20p-id='5554'%3e%3c/path%3e%3cpath%20d='M432.736%20384.064a16%2016%200%200%200-10.976%204.8l-96.96%2095.776a16%2016%200%200%200-0.416%200.416%2016%2016%200%200%200%201.664%2023.808l95.68%2094.56a16%2016%200%201%200%2022.528-22.72l-85.568-84.576%2085.568-84.48a16%2016%200%200%200-11.52-27.584z%20m157.824%200a16%2016%200%200%200-11.008%2027.552l85.504%2084.48-85.504%2084.576a16%2016%200%201%200%2022.496%2022.752l95.648-94.56a16%2016%200%200%200%205.44-17.504%2016%2016%200%200%200-1.28-2.912%2016%2016%200%200%200-0.608-1.12%2016%2016%200%200%200-0.192-0.256%2016%2016%200%200%200-0.192-0.256%2016%2016%200%200%200-0.8-0.992%2016%2016%200%200%200-0.192-0.256%2016%2016%200%200%200-0.864-0.96%2016%2016%200%200%200-0.064%200l-0.64-0.544a16%2016%200%200%200-0.48-0.512l-95.776-94.688a16%2016%200%200%200-11.488-4.8z'%20fill='%23F05542'%20p-id='5555'%3e%3c/path%3e%3cpath%20d='M654.88%20799.744a16%2016%200%200%200-11.84%206.624L608%20853.312l-35.136-46.944-0.128%200.064a16%2016%200%200%200-13.056-6.368%2016%2016%200%200%200-15.744%2016.192v127.68a16%2016%200%201%200%2032%200v-80.128l15.936%2021.248a16%2016%200%200%200%2028.864%204.448l19.2-25.6v80.032a16%2016%200%201%200%2032%200v-126.816a16%2016%200%200%200-15.424-17.376%2016%2016%200%200%200-1.632%200z%20m-383.136%200.32a16%2016%200%200%200-15.744%2016.192V943.936a16%2016%200%201%200%2032%200v-47.808h64v47.808a16%2016%200%201%200%2032%200v-61.312a16%2016%200%200%200%200-5.12v-61.248a16%2016%200%200%200-16.256-16.192%2016%2016%200%200%200-15.744%2016.192v47.872H288v-47.872a16%2016%200%200%200-16.256-16.192z%20m192%200a16%2016%200%200%200-1.6%200.064H432a16%2016%200%201%200%200%2032h16v111.808a16%2016%200%201%200%2032%200v-111.808h16a16%2016%200%201%200%200-32h-30.304a16%2016%200%200%200-1.92-0.064z%20m255.936%200a16%2016%200%200%200-15.744%2016.192v126.496a16%2016%200%200%200%200.64%205.824%2016%2016%200%200%200%200%200.064%2016%2016%200%200%200%200.096%200.416%2016%2016%200%200%200%200.448%201.12%2016%2016%200%200%200%200.864%201.824%2016%2016%200%200%200%200.64%200.992%2016%2016%200%200%200%200.192%200.32%2016%2016%200%200%200%200.736%200.96%2016%2016%200%200%200%200.832%200.864%2016%2016%200%200%200%200.352%200.416%2016%2016%200%200%200%200.832%200.704%2016%2016%200%200%200%200.448%200.384%2016%2016%200%200%200%200.352%200.32%2016%2016%200%200%200%201.12%200.736%2016%2016%200%200%200%202.464%201.248%2016%2016%200%200%200%200.864%200.32%2016%2016%200%200%200%205.376%200.864h63.552a16%2016%200%201%200%200-32h-47.808v-111.872a16%2016%200%200%200-16.256-16.192z'%20fill='%23E9EDED'%20p-id='5556'%3e%3c/path%3e%3c/svg%3e";export{M0 as R,$0 as _,D0 as a,I0 as b};
