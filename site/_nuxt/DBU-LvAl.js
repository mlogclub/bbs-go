import{_ as B,a as H}from"./BBmJLBXM.js";import{d as O,_ as V,a as L,c as N,b as j}from"./D03ZiU7j.js";import{u as S,C as z,o as u,h as g,w as i,e,d as a,b as n,t as c,f as _,s as y,U as q,D as A,E as T,z as U,G,H as x,A as J,B as K,_ as Q,j as R,g as W,l as X,a as Y,c as C,Q as Z,I as ee,F as te,r as oe,K as ne}from"./CJzXP6Za.js";import{u as se,a as ie}from"./BCWAYn_K.js";import{u as re}from"./Crz9ueD4.js";import{E as ae,a as ce,b as le}from"./4LiqXDg_.js";import{_ as me}from"./DywUBg3v.js";import{u as ue}from"./D7RcfSdU.js";import"./CDN07tui.js";import"./B_DlFklR.js";import"./LGu3flMp.js";import"./2CCwYrQ6.js";import"./gFIAofDC.js";import"./C7lyS26n.js";import"./De4aO46H.js";import"./Cc_-16Bv.js";import"./BtcHo0qI.js";import"./BoQTQDTW.js";import"./CcFcSr0Z.js";import"./FUKBWQwh.js";import"./C6Y-ieo6.js";import"./DOxhRshg.js";import"./uQ_JlLeb.js";import"./B-e9464h.js";import"./DzgUkL5_.js";import"./CdZrbHmy.js";import"./DuQb2Aa5.js";import"./BtndGyf2.js";import"./jq10_1xn.js";import"./BbEd4hLB.js";import"./wz7zWeh9.js";import"./D5komA-n.js";import"./DjUD2lz0.js";import"./DpnjZrq0.js";import"./DrXcdfvr.js";import"./AvKdJj6T.js";import"./Cj50OqVm.js";import"./Vj3wXoah.js";import"./BtR0bsoe.js";import"./Cjdb7r0I.js";import"./cX-kjXYs.js";import"./CE1w4_aS.js";import"./rzVlTAu0.js";const de=["aria-label","title"],_e={class:"sr-only"},pe={__name:"ArticleManageMenu",props:{article:{type:Object,required:!0}},setup(F){const l=F,{t:r}=S(),d=z(),p=se(d.user),t=ie(d.user),M=A(()=>d.user&&d.user.id===l.article.user.id),v=A(()=>M.value||p||t);async function m(o){o==="edit"?w():o==="delete"?$():o==="forbidden7Days"?await b(7):o==="forbiddenForever"?await b(-1):console.log("click on item "+o)}async function b(o){try{await U("/api/user/forbidden",J({userId:l.article.user.id,days:o})),K(r("component.articleManageMenu.forbiddenSuccess"))}catch(s){x(r("component.articleManageMenu.forbiddenFailed")),console.error(s)}}function $(){re(r("component.articleManageMenu.confirmDelete")).then(function(){U(`/api/article/delete/${l.article.id}`).then(()=>{G({message:r("component.articleManageMenu.deleteSuccess"),onClose(){T("/articles")}})}).catch(o=>{x(r("component.articleManageMenu.deleteFailed")+(o.message||o))})})}function w(){T(`/article/edit/${l.article.id}`)}return(o,s)=>{const D=V,f=N,h=j,I=L,E=O,P=q;return u(),g(P,null,{default:i(()=>[e(v)?(u(),g(E,{key:0},{default:i(()=>[a(D,{"as-child":""},{default:i(()=>[n("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md text-muted-foreground transition-colors hover:bg-accent hover:text-accent-foreground","aria-label":e(r)("common.moreActions"),title:e(r)("common.moreActions")},[a(e(ae),{class:"h-4 w-4"}),n("span",_e,c(e(r)("common.moreActions")),1)],8,de)]),_:1}),a(I,{align:"end",class:"min-w-[160px]"},{default:i(()=>[a(f,{onClick:s[0]||(s[0]=k=>m("edit"))},{default:i(()=>[_(c(o.$t("component.articleManageMenu.edit")),1)]),_:1}),a(f,{onClick:s[1]||(s[1]=k=>m("delete"))},{default:i(()=>[_(c(o.$t("component.articleManageMenu.delete")),1)]),_:1}),e(p)||e(t)?(u(),g(h,{key:0})):y("",!0),e(p)||e(t)?(u(),g(f,{key:1,onClick:s[2]||(s[2]=k=>m("forbidden7Days"))},{default:i(()=>[_(c(o.$t("component.articleManageMenu.forbidden7Days")),1)]),_:1})):y("",!0),e(p)?(u(),g(f,{key:2,onClick:s[3]||(s[3]=k=>m("forbiddenForever"))},{default:i(()=>[_(c(o.$t("component.articleManageMenu.forbiddenForever")),1)]),_:1})):y("",!0)]),_:1})]),_:1})):y("",!0)]),_:1})}}},fe={class:"main"},ge={class:"container main-container left-main side-size-320"},he={class:"left-container space-y-4"},ye={key:0},Me={class:"article-detail"},ve={class:"article-header"},be={class:"article-title-wrapper"},$e={class:"article-title"},we={class:"article-manage-menu"},De={class:"article-meta"},ke={class:"article-meta-item"},Ce=["datetime"],Ae=["innerHTML"],Fe={class:"article-tags"},Te={class:"right-container space-y-4"},Ue={__name:"[id]",async setup(F){let l,r;const{t:d}=S(),p=R(),{data:t,error:M}=([l,r]=W(()=>ne(`/api/article/${p.params.id}`)),l=await l,r(),l);if(M.value)throw X({statusCode:500,message:M.value.message||d("pages.redirect.error")});Y({title:ue(t.value.title)});const v=A(()=>t.value.status===2);return(m,b)=>{const $=B,w=H,o=pe,s=me,D=ce,f=le;return u(),C("section",fe,[n("div",ge,[n("div",he,[e(v)?(u(),C("div",ye,[a(w,null,{default:i(()=>[a($,null,{default:i(()=>[_(c(e(d)("pages.article.detail.pending")),1)]),_:1})]),_:1})])):y("",!0),n("article",Me,[n("div",ve,[n("div",be,[n("h1",$e,c(e(t).title),1),n("div",we,[a(o,{article:e(t)},null,8,["article"])])]),n("div",De,[n("span",ke,[a(s,{to:"/user/"+e(t).user.id,class:"article-author"},{default:i(()=>[_(c(e(t).user.nickname),1)]),_:1},8,["to"]),_(c(e(d)("pages.article.detail.publishedAt"))+" ",1),n("time",{datetime:("useFormatDate"in m?m.useFormatDate:e(Z))(e(t).createTime)},c(("usePrettyDate"in m?m.usePrettyDate:e(ee))(e(t).createTime)),9,Ce)])])]),n("div",{class:"article-content vp-typography line-numbers",innerHTML:e(t).content},null,8,Ae),n("div",Fe,[(u(!0),C(te,null,oe(e(t).tags,h=>(u(),g(s,{key:h.id,to:"/articles/tag/"+h.id,class:"article-tag"},{default:i(()=>[_("#"+c(h.name),1)]),_:2},1032,["to"]))),128))])]),a(D,{"entity-id":e(t).id,"comment-count":e(t).commentCount,"entity-type":"article"},null,8,["entity-id","comment-count"])]),n("div",Te,[a(f,{user:e(t).user},null,8,["user"])])])])}}},vt=Q(Ue,[["__scopeId","data-v-f427fe5f"]]);export{vt as default};
