import{a as B,_ as N}from"./BHlYvgvh.js";import{j as x,u as M,a as S,o as m,c as T,b as d,d as a,w as o,t as i,e,h as b,f as c,s as k,R as U,Q as q,n as R,z as A,A as C,B as E,E as D}from"./BqKV1jHe.js";import{_ as H}from"./DepVQ0hq.js";import{_ as I}from"./Lz5MK4XN.js";import{_ as L}from"./qdLMPJJp.js";import{_ as j}from"./Dfyc52rC.js";import{u as z}from"./DjqtQ0rA.js";import"./CDN07tui.js";import"./B_DlFklR.js";import"./DM7nVvhd.js";import"./DyiL-6dj.js";const F={class:"main"},J={class:"container"},Q={class:"main-body no-bg"},W={class:"text-xl font-semibold mb-6"},G={class:"mt-6 text-center"},ue={__name:"reset",setup(K){const g=x(),{t:n}=M(),h=String(g.query.token||"").trim();S({title:z(n("user.passwordReset.reset.title"))});const u=R(!1),l=R(!1),r=R(""),s=q({token:h,password:"",rePassword:""}),y=async()=>{if(r.value="",!s.token){r.value=n("user.passwordReset.reset.tokenMissing");return}if(!s.password){r.value=n("user.passwordReset.reset.passwordRequired");return}if(!s.rePassword){r.value=n("user.passwordReset.reset.rePasswordRequired");return}if(s.password!==s.rePassword){r.value=n("user.passwordReset.reset.passwordMismatch");return}u.value=!0;try{await A("/api/login/reset_password",C(s)),l.value=!0,E(n("user.passwordReset.reset.successNotice")),setTimeout(()=>{D("/user/signin")},1200)}catch(t){r.value=t?.message||n("composables.unknownError")}finally{u.value=!1}};return(t,p)=>{const _=N,w=B,v=H,$=I,P=L,V=j;return m(),T("section",F,[d("div",J,[d("div",Q,[a(V,{class:"max-w-160 mx-auto"},{default:o(()=>[d("h2",W,i(t.$t("user.passwordReset.reset.title")),1),e(s).token?k("",!0):(m(),b(w,{key:0,variant:"destructive",class:"mb-4"},{default:o(()=>[a(_,null,{default:o(()=>[c(i(t.$t("user.passwordReset.reset.tokenMissing")),1)]),_:1})]),_:1})),e(r)?(m(),b(w,{key:1,variant:"destructive",class:"mb-4"},{default:o(()=>[a(_,null,{default:o(()=>[c(i(e(r)),1)]),_:1})]),_:1})):k("",!0),d("form",{class:"space-y-4",onSubmit:U(y,["prevent"])},[a(v,{modelValue:e(s).password,"onUpdate:modelValue":p[0]||(p[0]=f=>e(s).password=f),type:"password",placeholder:t.$t("user.passwordReset.reset.passwordPlaceholder"),disabled:!e(s).token||e(u)||e(l)},null,8,["modelValue","placeholder","disabled"]),a(v,{modelValue:e(s).rePassword,"onUpdate:modelValue":p[1]||(p[1]=f=>e(s).rePassword=f),type:"password",placeholder:t.$t("user.passwordReset.reset.rePasswordPlaceholder"),disabled:!e(s).token||e(u)||e(l)},null,8,["modelValue","placeholder","disabled"]),a($,{type:"submit",class:"w-full",disabled:!e(s).token||e(u)||e(l)},{default:o(()=>[c(i(e(u)?t.$t("user.passwordReset.reset.submitting"):t.$t("user.passwordReset.reset.submitButton")),1)]),_:1},8,["disabled"])],32),e(l)?(m(),b(w,{key:2,class:"mt-4"},{default:o(()=>[a(_,null,{default:o(()=>[c(i(t.$t("user.passwordReset.reset.successNotice")),1)]),_:1})]),_:1})):k("",!0),d("div",G,[a(P,{to:"/user/signin",class:"text-sm text-primary"},{default:o(()=>[c(i(t.$t("user.passwordReset.backToSignin")),1)]),_:1})])]),_:1})])])])}}};export{ue as default};
